import{j as e}from"./ui-vendor-Dho0S5x9.js";import{a as t}from"./react-vendor-ByNQKlCH.js";import{C as y,a as I,b as w,d as S}from"./card-C7BQZI4A.js";import{u as E,l as T,m as A,n as U,T as G,a as k,b as z,d as B,B as c}from"./index-DMYsCFYG.js";import{I as b}from"./input-DM7v_Vsi.js";import{s as F}from"./superadminApi-Bjf7uKUS.js";import"./query-vendor-Br3W6GMP.js";import"./utils-vendor-Dq7h7Pqt.js";const Q=()=>{const{user:a,updateUser:v}=E(),[l,m]=t.useState({name:a?.name||"",email:a?.email||"",phoneNumber:a?.phoneNumber||"",profileImage:a?.profileImage||""}),[n,d]=t.useState(!1),[f,p]=t.useState(!1),[g,r]=t.useState(null),[x,u]=t.useState(null);t.useEffect(()=>{a&&(m({name:a.name||"",email:a.email||"",phoneNumber:a.phoneNumber||"",profileImage:a.profileImage||""}),u(a.profileImage||null))},[a]);const N=s=>{const i=s.target.files?.[0];if(i){if(i.size>2097152){r("Image size must be less than 2MB");return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(i.type)){r("Please upload a valid image file (JPG, PNG, or WebP)");return}const o=new FileReader;o.onloadend=()=>{const j=o.result;u(j),m(C=>({...C,profileImage:j})),r(null)},o.onerror=()=>{r("Failed to read the image file")},o.readAsDataURL(i)}},h=s=>{m(i=>({...i,[s.target.name]:s.target.value}))},P=async()=>{if(console.log("Current user object:",a),!a?.id){console.error("User ID is missing. User object:",a),r("User ID is missing");return}if(!l.name?.trim()){r("Name is required");return}if(!l.email?.trim()){r("Email is required");return}p(!0),r(null);try{console.log("Updating profile with data:",l);const s=await F.updateProfile(l);console.log("Profile update response:",s.data),v(s.data),d(!1)}catch(s){console.error("Error updating profile:",s),s.response?.data?.error?r(s.response.data.error):s.response?.data?.message?r(s.response.data.message):s.message?r(s.message):r("Failed to update profile. Please try again.")}finally{p(!1)}};return a?e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-white to-teal-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Profile"}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(y,{className:"max-w-xl w-full",children:[e.jsx(I,{children:e.jsx(w,{children:"Profile Information"})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(T,{className:"h-16 w-16",children:x?e.jsx(A,{src:x,alt:l.name}):e.jsx(U,{children:l.name?.charAt(0)})}),n&&e.jsxs("div",{children:[e.jsx(G,{children:e.jsxs(k,{children:[e.jsx(z,{asChild:!0,children:e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:N,className:"block mt-2 text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100","aria-label":"Upload profile image"})}),e.jsx(B,{children:"Upload a new profile image (max 2MB, JPG/PNG)"})]})}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Max size: 2MB. Supported formats: JPG, PNG, WebP"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-lg",children:l.name}),e.jsx("div",{className:"text-muted-foreground",children:a.role})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:"Email"}),e.jsx(b,{name:"email",value:l.email||"",onChange:h,readOnly:!n,"aria-label":"Email"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:"Phone Number"}),e.jsx(b,{name:"phoneNumber",value:l.phoneNumber||"",onChange:h,readOnly:!n,"aria-label":"Phone Number"})]}),g&&e.jsx("div",{className:"text-red-500 text-sm",children:g}),e.jsx("div",{className:"flex gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx(c,{onClick:P,disabled:f,"aria-label":"Save profile changes",children:f?"Saving...":"Save"}),e.jsx(c,{variant:"outline",onClick:()=>d(!1),"aria-label":"Cancel editing profile",children:"Cancel"})]}):e.jsx(c,{onClick:()=>d(!0),"aria-label":"Edit profile",children:"Edit Profile"})})]})]})})]})}):e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading profile..."})})};export{Q as default};
