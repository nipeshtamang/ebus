import{j as e,a8 as J,aw as Q,M as R,ac as k,U as W}from"./ui-vendor-BPnJF_7J.js";import{C as B,a as q,b as H,d as V}from"./card-CoINBLpb.js";import{T as X,a as Y,b as z,c as u,d as $,e as j}from"./table-mXJe5lnO.js";import{S as ee}from"./skeleton-BmX8kKu8.js";import{E as se}from"./error-message-yDPqqqhZ.js";import{B as p,T as ae,a as te,b as le,d as re}from"./index-C5bx2-Fn.js";import{I as G}from"./input-CM-I2g3X.js";import{B as O}from"./badge-CVKJlgmv.js";import{S as F,a as U,b as D,c as L,d as m}from"./select-CUjAH3A_.js";import{r as t}from"./react-vendor-Bgq3EpD8.js";import{s as ne}from"./superadminApi-Bft6DRZm.js";import{f as _}from"./index-CaunA62S.js";import"./query-vendor-B3bfG-l7.js";import"./utils-vendor-Dq7h7Pqt.js";const M=20,ie=()=>{const[r,y]=t.useState([]),[f,d]=t.useState(!1),[N,c]=t.useState(null),[i,n]=t.useState(1),[x,v]=t.useState(1),[l,b]=t.useState({dateFrom:"",dateTo:"",action:"all",entity:"all",userId:"all"}),h=t.useCallback(async()=>{d(!0),c(null);try{const a={page:i,limit:M,...l.dateFrom&&{dateFrom:l.dateFrom},...l.dateTo&&{dateTo:l.dateTo},...l.action&&l.action!=="all"&&{action:l.action},...l.entity&&l.entity!=="all"&&{entity:l.entity},...l.userId&&l.userId!=="all"&&{userId:Number(l.userId)}},o=await ne.getPaginatedSystemLogs(a);y(o.data.logs),v(o.data.totalPages)}catch(a){c(a instanceof Error?a.message:"Failed to load logs")}finally{d(!1)}},[i,l]),C=t.useCallback((a,o)=>{b(I=>({...I,[a]:o})),n(1)},[]),T=t.useCallback(()=>{b({dateFrom:"",dateTo:"",action:"all",entity:"all",userId:"all"}),n(1)},[]),w=t.useCallback(a=>{switch(a.toUpperCase()){case"CREATE":return"bg-green-100 text-green-800";case"UPDATE":return"bg-blue-100 text-blue-800";case"DELETE":return"bg-red-100 text-red-800";case"LOGIN":return"bg-purple-100 text-purple-800";case"ERROR":return"bg-red-100 text-red-800";case"BACKUP":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},[]),A=t.useCallback(()=>Array.from(new Set(r.map(a=>a.action))).filter(Boolean),[r]),S=t.useCallback(()=>Array.from(new Set(r.map(a=>a.entity))).filter(Boolean),[r]),E=t.useCallback(()=>r.filter(a=>a.user).map(a=>a.user).filter((a,o,I)=>I.findIndex(Z=>Z.id===a.id)===o),[r]),g=t.useCallback(a=>{n(a)},[]),s=t.useCallback(()=>{n(a=>Math.max(1,a-1))},[]),P=t.useCallback(()=>{n(a=>Math.min(x,a+1))},[x]),K=t.useCallback(()=>{const a=(i-1)*M+1,o=Math.min(i*M,r.length);return{start:a,end:o,total:r.length}},[i,r.length]);return t.useEffect(()=>{h()},[h]),{logs:r,loading:f,error:N,page:i,totalPages:x,filters:l,fetchLogs:h,handleFilterChange:C,clearFilters:T,getActionColor:w,getUniqueActions:A,getUniqueEntities:S,getUniqueUsers:E,goToPage:g,goToPreviousPage:s,goToNextPage:P,getPaginationInfo:K}},ve=()=>{const{logs:r,loading:y,error:f,page:d,totalPages:N,filters:c,fetchLogs:i,handleFilterChange:n,clearFilters:x,getActionColor:v,getUniqueActions:l,getUniqueEntities:b,getUniqueUsers:h,goToPreviousPage:C,goToNextPage:T,getPaginationInfo:w}=ie(),A=l(),S=b(),E=h(),g=w();return e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-white to-teal-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"System Logs"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor system activities and user actions"})]}),e.jsxs(p,{onClick:i,variant:"outline",className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(J,{className:"h-4 w-4"}),"Refresh"]})]}),e.jsxs(B,{className:"shadow-sm border-gray-200 mb-6",children:[e.jsx(q,{className:"pb-4",children:e.jsxs(H,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Q,{className:"h-5 w-5"}),"Filters"]})}),e.jsx(V,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4"}),"Date From"]}),e.jsx(G,{type:"date",value:c.dateFrom,onChange:s=>n("dateFrom",s.target.value),className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4"}),"Date To"]}),e.jsx(G,{type:"date",value:c.dateTo,onChange:s=>n("dateTo",s.target.value),className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4"}),"Action"]}),e.jsxs(F,{value:c.action,onValueChange:s=>n("action",s),children:[e.jsx(U,{children:e.jsx(D,{placeholder:"All Actions"})}),e.jsxs(L,{children:[e.jsx(m,{value:"all",children:"All Actions"}),A.map(s=>e.jsx(m,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4"}),"Entity"]}),e.jsxs(F,{value:c.entity,onValueChange:s=>n("entity",s),children:[e.jsx(U,{children:e.jsx(D,{placeholder:"All Entities"})}),e.jsxs(L,{children:[e.jsx(m,{value:"all",children:"All Entities"}),S.map(s=>e.jsx(m,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[e.jsx(W,{className:"h-4 w-4"}),"User"]}),e.jsxs(F,{value:c.userId,onValueChange:s=>n("userId",s),children:[e.jsx(U,{children:e.jsx(D,{placeholder:"All Users"})}),e.jsxs(L,{children:[e.jsx(m,{value:"all",children:"All Users"}),E.map(s=>e.jsxs(m,{value:s.id.toString(),children:[s.name," (",s.email,")"]},s.id))]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(p,{onClick:i,className:"flex-1",children:"Apply Filters"}),e.jsx(p,{onClick:x,variant:"outline",className:"flex-1",children:"Clear"})]})})]})})]}),f&&e.jsx(se,{message:f,onRetry:i}),e.jsxs(B,{className:"shadow-sm border-gray-200",children:[e.jsx(q,{className:"pb-4",children:e.jsx(H,{className:"text-lg",children:"System Activity Logs"})}),e.jsx(V,{children:y?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,P)=>e.jsx(ee,{className:"h-16 w-full"},P))}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(k,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No logs found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters or check back later."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(X,{className:"w-full",children:[e.jsx(Y,{children:e.jsxs(z,{className:"bg-gray-50",children:[e.jsx(u,{className:"font-semibold text-gray-900 px-6 py-4",children:"Action"}),e.jsx(u,{className:"font-semibold text-gray-900 px-6 py-4",children:"Entity"}),e.jsx(u,{className:"font-semibold text-gray-900 px-6 py-4",children:"User"}),e.jsx(u,{className:"font-semibold text-gray-900 px-6 py-4",children:"Date & Time"}),e.jsx(u,{className:"font-semibold text-gray-900 px-6 py-4",children:"Details"})]})}),e.jsx($,{children:r.map(s=>e.jsxs(z,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(j,{className:"px-6 py-4",children:e.jsx(O,{className:v(s.action),children:s.action})}),e.jsx(j,{className:"px-6 py-4",children:e.jsx(ae,{children:e.jsxs(te,{children:[e.jsx(le,{asChild:!0,children:e.jsx("span",{className:"font-medium text-gray-900 cursor-help",children:s.entity})}),e.jsx(re,{children:e.jsxs("p",{children:["Entity ID: ",s.entityId]})})]})})}),e.jsx(j,{className:"px-6 py-4",children:s.user?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.user.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.user.email}),e.jsx(O,{variant:"outline",className:"text-xs mt-1",children:s.user.role})]}):e.jsx("span",{className:"text-gray-500 italic",children:"System"})}),e.jsx(j,{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:_(new Date(s.createdAt),"MMM dd, yyyy")}),e.jsx("div",{className:"text-gray-500",children:_(new Date(s.createdAt),"HH:mm:ss")})]})}),e.jsx(j,{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:s.before&&s.after?e.jsx("span",{className:"text-blue-600",children:"Data changed"}):s.after?e.jsx("span",{className:"text-green-600",children:"Created"}):s.before?e.jsx("span",{className:"text-red-600",children:"Deleted"}):e.jsx("span",{className:"text-gray-500",children:"No details"})})})]},s.id))})]})})})]}),!y&&r.length>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",g.start," to ",g.end," of ",g.total," logs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{size:"sm",variant:"outline",disabled:d===1,onClick:C,children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-sm font-medium text-gray-700",children:["Page ",d," of ",N]}),e.jsx(p,{size:"sm",variant:"outline",disabled:d===N,onClick:T,children:"Next"})]})]})]})})};export{ve as default};
