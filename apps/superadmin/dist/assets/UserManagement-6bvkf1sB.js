import{j as e,ad as Ue,Q as Ae,ae as Me,af as Fe,ag as P,ah as Re,J as Le,a9 as Pe,a0 as Ie}from"./ui-vendor-Dho0S5x9.js";import{a as n,j as G}from"./react-vendor-ByNQKlCH.js";import{C as Be,d as Oe}from"./card-C7BQZI4A.js";import{B as y,T as u,a as p,b as g,d as j,A as $e,e as He,f as _e,g as ze,h as qe,i as Ve,j as Ke,k as Qe}from"./index-DMYsCFYG.js";import{I as R}from"./input-DM7v_Vsi.js";import{B as Ge}from"./badge-C0YrEax5.js";import{S as Xe}from"./skeleton-XnDLFZGi.js";import{E as Je}from"./error-message-D3zDD8H-.js";import{s as q}from"./superadminApi-Bjf7uKUS.js";import{D as ee,a as We,b as se,c as te,d as ae}from"./dialog-A3DPpc4l.js";import{f as X}from"./index-CgIdLkdF.js";import"./query-vendor-Br3W6GMP.js";import"./utils-vendor-Dq7h7Pqt.js";function Ze(){const[I,V]=n.useState([]),[L,f]=n.useState(0),[B,E]=n.useState(0),[l,k]=n.useState(1),[A,a]=n.useState(!1),[t,c]=n.useState(null),[o,h]=n.useState(!1),[$,T]=n.useState(!1),[M,F]=n.useState(!1),[i,w]=n.useState(""),v=n.useCallback(async(N=1,d="",x)=>{try{a(!0),c(null);const b=await q.getAllUsers(N,10,d,x);V(b.data.users),f(b.data.total),E(b.data.totalPages),k(N)}catch(b){console.error("Error fetching users:",b);let H="Failed to load users";b instanceof Error&&(H=b.message),c(H)}finally{a(!1)}},[]),K=n.useCallback(async N=>{try{return h(!0),c(null),await q.createUser(N),await v(l,i),!0}catch(d){console.error("Error creating user:",d);let x="Failed to create user";return d instanceof Error&&(x=d.message),c(x),!1}finally{h(!1)}},[v,l,i]),W=n.useCallback(async(N,d)=>{try{return T(!0),c(null),await q.updateUser(N,d),await v(l,i),!0}catch(x){console.error("Error updating user:",x);let b="Failed to update user";return x instanceof Error&&(b=x.message),c(b),!1}finally{T(!1)}},[v,l,i]),O=n.useCallback(async N=>{try{return F(!0),c(null),await q.deleteUser(N),await v(l,i),!0}catch(d){console.error("Error deleting user:",d);let x="Failed to delete user";return d instanceof Error&&(x=d.message),c(x),!1}finally{F(!1)}},[v,l,i]),Q=n.useCallback(()=>{c(null)},[]);return{users:I,totalUsers:L,totalPages:B,currentPage:l,loading:A,error:t,creating:o,updating:$,deleting:M,searchTerm:i,setSearchTerm:w,setCurrentPage:k,fetchUsers:v,createUser:K,updateUser:W,deleteUser:O,clearError:Q}}var J={exports:{}},Ye=J.exports,ce;function es(){return ce||(ce=1,function(I,V){(function(L,f){f()})(Ye,function(){function L(a,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function f(a,t,c){var o=new XMLHttpRequest;o.open("GET",a),o.responseType="blob",o.onload=function(){A(o.response,t,c)},o.onerror=function(){console.error("could not download file")},o.send()}function B(a){var t=new XMLHttpRequest;t.open("HEAD",a,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function E(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(t)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof G=="object"&&G.global===G?G:void 0,k=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),A=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!k?function(a,t,c){var o=l.URL||l.webkitURL,h=document.createElement("a");t=t||a.name||"download",h.download=t,h.rel="noopener",typeof a=="string"?(h.href=a,h.origin===location.origin?E(h):B(h.href)?f(a,t,c):E(h,h.target="_blank")):(h.href=o.createObjectURL(a),setTimeout(function(){o.revokeObjectURL(h.href)},4e4),setTimeout(function(){E(h)},0))}:"msSaveOrOpenBlob"in navigator?function(a,t,c){if(t=t||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(L(a,c),t);else if(B(a))f(a,t,c);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout(function(){E(o)})}}:function(a,t,c,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof a=="string")return f(a,t,c);var h=a.type==="application/octet-stream",$=/constructor/i.test(l.HTMLElement)||l.safari,T=/CriOS\/[\d]+/.test(navigator.userAgent);if((T||h&&$||k)&&typeof FileReader<"u"){var M=new FileReader;M.onloadend=function(){var w=M.result;w=T?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=w:location=w,o=null},M.readAsDataURL(a)}else{var F=l.URL||l.webkitURL,i=F.createObjectURL(a);o?o.location=i:location.href=i,o=null,setTimeout(function(){F.revokeObjectURL(i)},4e4)}});l.saveAs=A.saveAs=A,I.exports=A})}(J)),J.exports}var ss=es();const ps=()=>{const{users:I,loading:V,error:L,fetchUsers:f,deleteUser:B,totalPages:E,currentPage:l,setCurrentPage:k,createUser:A,updateUser:a,searchTerm:t,setSearchTerm:c}=Ze(),[o,h]=n.useState(!1),[$,T]=n.useState(!1),[M,F]=n.useState(null),[i,w]=n.useState({name:"",email:"",phoneNumber:"",password:"",role:"CLIENT"}),[v,K]=n.useState(!1),[W,O]=n.useState(!1),[Q,N]=n.useState(null),[d,x]=n.useState({name:"",email:"",phoneNumber:"",role:"CLIENT"}),[b,H]=n.useState(!1),[de,re]=n.useState(!1),[he,ne]=n.useState(!1),[xe,le]=n.useState([]),[oe,me]=n.useState(null),[S,ue]=n.useState({dateFrom:"",dateTo:"",status:""}),[D,Z]=n.useState(1),_=10;n.useEffect(()=>{f(l,t)},[f,l,t]);const pe=s=>{c(s),k(1)},ge=async()=>{K(!0);try{await A(i),h(!1),w({name:"",email:"",phoneNumber:"",password:"",role:"CLIENT"}),f(l,t),P.success("User created successfully!")}catch{P.error("Failed to create user")}finally{K(!1)}},je=async()=>{if(M)try{await B(M),T(!1),F(null),f(l,t),P.success("User deleted successfully!")}catch{P.error("Failed to delete user")}},fe=s=>{F(s),T(!0)},we=s=>{N(s),x({name:s.name,email:s.email,phoneNumber:s.phoneNumber,role:s.role}),O(!0)},be=async()=>{if(Q){H(!0);try{await a(Q.id,{...d,role:d.role}),O(!1),N(null),f(l,t),P.success("User updated successfully!")}catch{P.error("Failed to update user")}finally{H(!1)}}},ye=s=>{switch(s.toUpperCase()){case"SUPERADMIN":return"bg-purple-100 text-purple-800";case"ADMIN":return"bg-blue-100 text-blue-800";case"CLIENT":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Ne=s=>{switch(s.toUpperCase()){case"SUPERADMIN":return e.jsx(Ie,{className:"h-4 w-4"});case"ADMIN":return e.jsx(Pe,{className:"h-4 w-4"});case"CLIENT":return e.jsx(Le,{className:"h-4 w-4"});default:return e.jsx(Re,{className:"h-4 w-4"})}},ve=async s=>{me(s),re(!0),ne(!0);try{const r=await q.getUserTickets(s.id);le(r.data)}catch{P.error("Failed to load tickets"),le([])}finally{ne(!1)}},Y=s=>{ue(r=>({...r,[s.target.name]:s.target.value})),Z(1)},U=xe.filter(s=>{const r=s.bookings?.[0]?.createdAt?new Date(s.bookings[0].createdAt):null,C=S.status?s.bookings[0]?.status===S.status:!0,z=S.dateFrom?r&&r>=new Date(S.dateFrom):!0,m=S.dateTo?r&&r<=new Date(S.dateTo):!0;return C&&z&&m}),Ce=U.slice((D-1)*_,D*_),ie=Math.ceil(U.length/_),Ee=()=>{const s=["Ticket #","Booking Date","Status","Route","Bus","Seat","Client","Amount"],r=U.map(m=>[m.ticketNumber,m.bookings[0]?.createdAt?X(new Date(m.bookings[0].createdAt),"yyyy-MM-dd HH:mm"):"-",m.bookings[0]?.status||"-",m.bookings[0]?.schedule?.route?`${m.bookings[0].schedule.route.origin} → ${m.bookings[0].schedule.route.destination}`:"-",m.bookings[0]?.schedule?.bus?.name||"-",m.bookings[0]?.seat?.seatNumber||"-",m.bookings[0]?.user?.name||"-",m.bookings[0]?.payment?.amount?`₨${m.bookings[0].payment.amount}`:"-"]),C=[s,...r].map(m=>m.map(De=>`"${De}"`).join(",")).join(`
`),z=new Blob([C],{type:"text/csv;charset=utf-8;"});ss.saveAs(z,`tickets_${oe?.name||"user"}.csv`)},ke=U.length,Te=U.reduce((s,r)=>s+(r.bookings[0]?.payment?.amount||0),0),Se=(()=>{const s={};return U.forEach(r=>{const C=r.bookings[0]?.schedule?.route?`${r.bookings[0].schedule.route.origin} → ${r.bookings[0].schedule.route.destination}`:"-";s[C]=(s[C]||0)+1}),Object.entries(s).sort((r,C)=>C[1]-r[1])[0]?.[0]||"-"})();return e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-white to-teal-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"User Management"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[e.jsx(R,{placeholder:"Search users...","aria-label":"Search users by name or email",value:t,onChange:s=>pe(s.target.value),className:"w-full sm:w-48"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Search by name or email"})]}),e.jsxs(ee,{open:o,onOpenChange:h,children:[e.jsx(We,{asChild:!0,children:e.jsxs(y,{size:"sm",className:"w-full sm:w-auto",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Add User"]})}),e.jsxs(se,{className:"sm:max-w-[425px]",children:[e.jsx(te,{children:e.jsx(ae,{children:"Add New User"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx(R,{id:"name",value:i.name,onChange:s=>w({...i,name:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx(R,{id:"email",type:"email",value:i.email,onChange:s=>w({...i,email:s.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"phone",children:"Phone Number"}),e.jsx(R,{id:"phone",value:i.phoneNumber,onChange:s=>w({...i,phoneNumber:s.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx(R,{id:"password",type:"password",value:i.password,onChange:s=>w({...i,password:s.target.value}),placeholder:"Enter password"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"role",children:"Role"}),e.jsxs("select",{id:"role",value:i.role,onChange:s=>w({...i,role:s.target.value}),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"CLIENT",children:"Client"}),e.jsx("option",{value:"ADMIN",children:"Admin"}),e.jsx("option",{value:"SUPERADMIN",children:"SuperAdmin"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(y,{onClick:ge,disabled:v,children:v?"Creating...":"Add User"})]})]})]})]})]}),L&&e.jsx(Je,{message:L,onRetry:()=>f(l,t)}),e.jsx(Be,{children:e.jsx(Oe,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Registered"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Bookings"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-8",children:e.jsx(Xe,{className:"h-8 w-full"})})}):I.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):I.map(s=>e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap font-semibold",children:s.name}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s.email}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s.phoneNumber}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:e.jsxs(Ge,{className:ye(s.role),children:[Ne(s.role),e.jsx("span",{className:"ml-1",children:s.role})]})}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:X(new Date(s.createdAt),"yyyy-MM-dd")}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s._count?.bookings??0}),e.jsxs("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap flex gap-4 items-center",children:[e.jsx(y,{size:"sm",variant:"outline",onClick:()=>ve(s),"aria-label":`View tickets for ${s.name}`,children:e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsxs("span",{children:[e.jsx(Ae,{className:"h-4 w-4 mr-1"})," Tickets"]})}),e.jsx(j,{children:"View all tickets for this user"})]})})}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>we(s),"aria-label":`Edit user ${s.name}`,children:e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("span",{children:e.jsx(Me,{className:"h-4 w-4"})})}),e.jsx(j,{children:"Edit user"})]})})}),e.jsx(y,{size:"sm",variant:"destructive",onClick:()=>fe(s.id),"aria-label":`Delete user ${s.name}`,children:e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("span",{children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsx(j,{children:"Delete user"})]})})})]})]},s.id))})]})})})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(y,{size:"sm",variant:"outline",disabled:l===1,onClick:()=>k(l-1),children:"Previous"}),e.jsxs("span",{className:"px-2 py-1",children:["Page ",l," of ",E]}),e.jsx(y,{size:"sm",variant:"outline",disabled:l===E,onClick:()=>k(l+1),children:"Next"})]}),e.jsx($e,{open:$,onOpenChange:T,children:e.jsxs(He,{children:[e.jsxs(_e,{children:[e.jsx(ze,{children:"Confirm Delete"}),e.jsx(qe,{children:"Are you sure you want to delete this user? This action cannot be undone and will remove all user data from the system."})]}),e.jsxs(Ve,{children:[e.jsx(Ke,{children:"Cancel"}),e.jsx(Qe,{onClick:je,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),e.jsx(ee,{open:W,onOpenChange:O,children:e.jsxs(se,{className:"sm:max-w-[425px]",children:[e.jsx(te,{children:e.jsx(ae,{children:"Edit User"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-name",children:"Name"}),e.jsx(R,{id:"edit-name",value:d.name,onChange:s=>x({...d,name:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-email",children:"Email"}),e.jsx(R,{id:"edit-email",type:"email",value:d.email,onChange:s=>x({...d,email:s.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-phone",children:"Phone Number"}),e.jsx(R,{id:"edit-phone",value:d.phoneNumber,onChange:s=>x({...d,phoneNumber:s.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-role",children:"Role"}),e.jsxs("select",{id:"edit-role",value:d.role,onChange:s=>x({...d,role:s.target.value}),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"SUPERADMIN",children:"SUPERADMIN"}),e.jsx("option",{value:"ADMIN",children:"ADMIN"}),e.jsx("option",{value:"CLIENT",children:"CLIENT"})]})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(y,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(y,{onClick:be,disabled:b,children:b?"Saving...":"Save Changes"})]})]})}),e.jsx(ee,{open:de,onOpenChange:re,children:e.jsxs(se,{className:"max-w-5xl",children:[e.jsx(te,{children:e.jsxs(ae,{children:["Tickets for ",oe?.name]})}),e.jsxs("div",{className:"flex flex-wrap gap-8 items-center mb-4",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Total Tickets: ",e.jsx("span",{className:"font-bold",children:ke})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Total Revenue:"," ",e.jsxs("span",{className:"font-bold",children:["₨",Te]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Most Used Route:"," ",e.jsx("span",{className:"font-bold",children:Se})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-end mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Date From"}),e.jsx("input",{type:"date",name:"dateFrom",value:S.dateFrom,onChange:Y,className:"border rounded px-2 py-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Date To"}),e.jsx("input",{type:"date",name:"dateTo",value:S.dateTo,onChange:Y,className:"border rounded px-2 py-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:S.status,onChange:Y,className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"BOOKED",children:"BOOKED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"}),e.jsx("option",{value:"COMPLETED",children:"COMPLETED"})]})]}),e.jsx(y,{size:"sm",variant:"outline",onClick:Ee,children:"Export CSV"})]}),he?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):U.length===0?e.jsx("div",{className:"p-8 text-center",children:"No tickets found."}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Ticket #"})}),e.jsx(j,{children:"Unique ticket number"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"QR"})}),e.jsx(j,{children:"QR code for ticket"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Booking Date"})}),e.jsx(j,{children:"Date/time ticket was booked"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Status"})}),e.jsx(j,{children:"Booking status"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Route"})}),e.jsx(j,{children:"Route of the trip"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Bus"})}),e.jsx(j,{children:"Bus name"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Seat"})}),e.jsx(j,{children:"Seat number"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Client"})}),e.jsx(j,{children:"Client name"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Amount"})}),e.jsx(j,{children:"Payment amount"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Method"})}),e.jsx(j,{children:"Payment method"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Txn ID"})}),e.jsx(j,{children:"Transaction ID"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(g,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Cancelled At"})}),e.jsx(j,{children:"Cancellation date/time"})]})})]})}),e.jsx("tbody",{children:Ce.map(s=>{const r=s.bookings[0],C=s.bookings?.map(z=>z.seat?.seatNumber).filter(Boolean).join(", ");return e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap font-mono",children:s.ticketNumber}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s.qrCode?e.jsx("img",{src:s.qrCode,alt:"QR",className:"h-8 w-8 object-contain"}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.createdAt?X(new Date(r.createdAt),"yyyy-MM-dd HH:mm"):"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.status}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.schedule?.route?`${r.schedule.route.origin} → ${r.schedule.route.destination}`:"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.schedule?.bus?.name||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:C||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.user?.name||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.payment?.amount?`₨${r.payment.amount}`:"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.payment?.method||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap font-mono text-xs",children:r?.payment?.transactionId||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:r?.status==="CANCELLED"&&r?.deletedAt?X(new Date(r.deletedAt),"yyyy-MM-dd HH:mm"):"-"})]},s.id)})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Showing ",(D-1)*_+1," -"," ",Math.min(D*_,U.length)," ","of ",U.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{size:"sm",variant:"outline",disabled:D===1,onClick:()=>Z(D-1),children:"Prev"}),e.jsxs("span",{className:"text-xs",children:["Page ",D," of ",ie]}),e.jsx(y,{size:"sm",variant:"outline",disabled:D===ie,onClick:()=>Z(D+1),children:"Next"})]})]})]})]})})]})})};export{ps as default};
