import{j as e,ad as ze,Q as _e,ae as qe,af as Ve,ag as $,ah as Ke,J as Qe,a9 as Ge,a0 as Xe}from"./ui-vendor-BPnJF_7J.js";import{r as l,h as Z}from"./react-vendor-Bgq3EpD8.js";import{C as Be,d as Je}from"./card-CoINBLpb.js";import{B as C,T as u,a as p,b as j,d as g,A as We,e as Ze,f as Ye,g as es,h as ss,i as ts,j as as,k as rs}from"./index-C5bx2-Fn.js";import{I as O}from"./input-CM-I2g3X.js";import{B as ls}from"./badge-CVKJlgmv.js";import{S as ns}from"./skeleton-BmX8kKu8.js";import{E as os}from"./error-message-yDPqqqhZ.js";import{s as Y}from"./superadminApi-Bft6DRZm.js";import{D as ie,a as is,b as de,c as ce,d as he}from"./dialog-kKasmLKn.js";import{f as re}from"./index-CaunA62S.js";import"./query-vendor-B3bfG-l7.js";import"./utils-vendor-Dq7h7Pqt.js";function ds(){const[z,ee]=l.useState([]),[H,w]=l.useState(0),[_,D]=l.useState(0),[n,S]=l.useState(1),[F,r]=l.useState(!1),[a,d]=l.useState(null),[o,x]=l.useState(!1),[K,A]=l.useState(!1),[R,L]=l.useState(!1),[i,f]=l.useState(""),T=l.useCallback(async(E=1,c="",m)=>{try{r(!0),d(null);const N=await Y.getAllUsers(E,10,c,m);ee(N.data.users),w(N.data.total),D(N.data.totalPages),S(E)}catch(N){console.error("Error fetching users:",N);let Q="Failed to load users";N instanceof Error&&(Q=N.message),d(Q)}finally{r(!1)}},[]),se=l.useCallback(async E=>{try{return x(!0),d(null),await Y.createUser(E),await T(n,i),!0}catch(c){console.error("Error creating user:",c);let m="Failed to create user";return c instanceof Error&&(m=c.message),d(m),!1}finally{x(!1)}},[T,n,i]),le=l.useCallback(async(E,c)=>{try{return A(!0),d(null),await Y.updateUser(E,c),await T(n,i),!0}catch(m){console.error("Error updating user:",m);let N="Failed to update user";return m instanceof Error&&(N=m.message),d(N),!1}finally{A(!1)}},[T,n,i]),q=l.useCallback(async E=>{try{return L(!0),d(null),await Y.deleteUser(E),await T(n,i),!0}catch(c){console.error("Error deleting user:",c);let m="Failed to delete user";return c instanceof Error&&(m=c.message),d(m),!1}finally{L(!1)}},[T,n,i]),te=l.useCallback(()=>{d(null)},[]);return{users:z,totalUsers:H,totalPages:_,currentPage:n,loading:F,error:a,creating:o,updating:K,deleting:R,searchTerm:i,setSearchTerm:f,setCurrentPage:S,fetchUsers:T,createUser:se,updateUser:le,deleteUser:q,clearError:te}}var ye={exports:{}};(function(z,ee){(function(H,w){w()})(Z,function(){function H(r,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function w(r,a,d){var o=new XMLHttpRequest;o.open("GET",r),o.responseType="blob",o.onload=function(){F(o.response,a,d)},o.onerror=function(){console.error("could not download file")},o.send()}function _(r){var a=new XMLHttpRequest;a.open("HEAD",r,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function D(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(a)}}var n=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Z=="object"&&Z.global===Z?Z:void 0,S=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),F=n.saveAs||(typeof window!="object"||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!S?function(r,a,d){var o=n.URL||n.webkitURL,x=document.createElement("a");a=a||r.name||"download",x.download=a,x.rel="noopener",typeof r=="string"?(x.href=r,x.origin===location.origin?D(x):_(x.href)?w(r,a,d):D(x,x.target="_blank")):(x.href=o.createObjectURL(r),setTimeout(function(){o.revokeObjectURL(x.href)},4e4),setTimeout(function(){D(x)},0))}:"msSaveOrOpenBlob"in navigator?function(r,a,d){if(a=a||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(H(r,d),a);else if(_(r))w(r,a,d);else{var o=document.createElement("a");o.href=r,o.target="_blank",setTimeout(function(){D(o)})}}:function(r,a,d,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof r=="string")return w(r,a,d);var x=r.type==="application/octet-stream",K=/constructor/i.test(n.HTMLElement)||n.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||x&&K||S)&&typeof FileReader<"u"){var R=new FileReader;R.onloadend=function(){var f=R.result;f=A?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=f:location=f,o=null},R.readAsDataURL(r)}else{var L=n.URL||n.webkitURL,i=L.createObjectURL(r);o?o.location=i:location.href=i,o=null,setTimeout(function(){L.revokeObjectURL(i)},4e4)}});n.saveAs=F.saveAs=F,z.exports=F})})(ye);var cs=ye.exports;const Cs=()=>{const{users:z,loading:ee,error:H,fetchUsers:w,deleteUser:_,totalPages:D,currentPage:n,setCurrentPage:S,createUser:F,updateUser:r,searchTerm:a,setSearchTerm:d}=ds(),[o,x]=l.useState(!1),[K,A]=l.useState(!1),[R,L]=l.useState(null),[i,f]=l.useState({name:"",email:"",phoneNumber:"",password:"",role:"CLIENT"}),[T,se]=l.useState(!1),[le,q]=l.useState(!1),[te,E]=l.useState(null),[c,m]=l.useState({name:"",email:"",phoneNumber:"",role:"CLIENT"}),[N,Q]=l.useState(!1),[Ne,xe]=l.useState(!1),[ve,me]=l.useState(!1),[Ce,ue]=l.useState([]),[V,Ee]=l.useState(null),[U,Te]=l.useState({dateFrom:"",dateTo:"",status:""}),[k,ne]=l.useState(1),G=10;l.useEffect(()=>{w(n,a)},[w,n,a]);const De=s=>{d(s),S(1)},Se=async()=>{se(!0);try{await F(i),x(!1),f({name:"",email:"",phoneNumber:"",password:"",role:"CLIENT"}),w(n,a),$.success("User created successfully!")}catch{$.error("Failed to create user")}finally{se(!1)}},Ae=async()=>{if(R)try{await _(R),A(!1),L(null),w(n,a),$.success("User deleted successfully!")}catch{$.error("Failed to delete user")}},Ue=s=>{L(s),A(!0)},ke=s=>{E(s),m({name:s.name,email:s.email,phoneNumber:s.phoneNumber,role:s.role}),q(!0)},Me=async()=>{if(te){Q(!0);try{await r(te.id,{...c,role:c.role}),q(!1),E(null),w(n,a),$.success("User updated successfully!")}catch{$.error("Failed to update user")}finally{Q(!1)}}},Fe=s=>{switch(s.toUpperCase()){case"SUPERADMIN":return"bg-purple-100 text-purple-800";case"ADMIN":return"bg-blue-100 text-blue-800";case"CLIENT":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Re=s=>{switch(s.toUpperCase()){case"SUPERADMIN":return e.jsx(Xe,{className:"h-4 w-4"});case"ADMIN":return e.jsx(Ge,{className:"h-4 w-4"});case"CLIENT":return e.jsx(Qe,{className:"h-4 w-4"});default:return e.jsx(Ke,{className:"h-4 w-4"})}},Le=async s=>{Ee(s),xe(!0),me(!0);try{const t=await Y.getUserTickets(s.id);ue(t.data)}catch{$.error("Failed to load tickets"),ue([])}finally{me(!1)}},oe=s=>{Te(t=>({...t,[s.target.name]:s.target.value})),ne(1)},M=Ce.filter(s=>{var v,P,I;const t=(P=(v=s.bookings)==null?void 0:v[0])!=null&&P.createdAt?new Date(s.bookings[0].createdAt):null,b=U.status?((I=s.bookings[0])==null?void 0:I.status)===U.status:!0,y=U.dateFrom?t&&t>=new Date(U.dateFrom):!0,h=U.dateTo?t&&t<=new Date(U.dateTo):!0;return b&&y&&h}),Pe=M.slice((k-1)*G,k*G),pe=Math.ceil(M.length/G),Ie=()=>{const s=["Ticket #","Booking Date","Status","Route","Bus","Seat","Client","Amount"],t=M.map(h=>{var v,P,I,X,B,J,ae,W,je,ge,we,fe,be;return[h.ticketNumber,(v=h.bookings[0])!=null&&v.createdAt?re(new Date(h.bookings[0].createdAt),"yyyy-MM-dd HH:mm"):"-",((P=h.bookings[0])==null?void 0:P.status)||"-",(X=(I=h.bookings[0])==null?void 0:I.schedule)!=null&&X.route?`${h.bookings[0].schedule.route.origin} → ${h.bookings[0].schedule.route.destination}`:"-",((ae=(J=(B=h.bookings[0])==null?void 0:B.schedule)==null?void 0:J.bus)==null?void 0:ae.name)||"-",((je=(W=h.bookings[0])==null?void 0:W.seat)==null?void 0:je.seatNumber)||"-",((we=(ge=h.bookings[0])==null?void 0:ge.user)==null?void 0:we.name)||"-",(be=(fe=h.bookings[0])==null?void 0:fe.payment)!=null&&be.amount?`₨${h.bookings[0].payment.amount}`:"-"]}),b=[s,...t].map(h=>h.map(v=>`"${v}"`).join(",")).join(`
`),y=new Blob([b],{type:"text/csv;charset=utf-8;"});cs.saveAs(y,`tickets_${(V==null?void 0:V.name)||"user"}.csv`)},Oe=M.length,He=M.reduce((s,t)=>{var b,y;return s+(((y=(b=t.bookings[0])==null?void 0:b.payment)==null?void 0:y.amount)||0)},0),$e=(()=>{var t;const s={};return M.forEach(b=>{var h,v;const y=(v=(h=b.bookings[0])==null?void 0:h.schedule)!=null&&v.route?`${b.bookings[0].schedule.route.origin} → ${b.bookings[0].schedule.route.destination}`:"-";s[y]=(s[y]||0)+1}),((t=Object.entries(s).sort((b,y)=>y[1]-b[1])[0])==null?void 0:t[0])||"-"})();return e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-white to-teal-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"User Management"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center",children:[e.jsx(O,{placeholder:"Search users...","aria-label":"Search users by name or email",value:a,onChange:s=>De(s.target.value),className:"w-full sm:w-48"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Search by name or email"})]}),e.jsxs(ie,{open:o,onOpenChange:x,children:[e.jsx(is,{asChild:!0,children:e.jsxs(C,{size:"sm",className:"w-full sm:w-auto",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Add User"]})}),e.jsxs(de,{className:"sm:max-w-[425px]",children:[e.jsx(ce,{children:e.jsx(he,{children:"Add New User"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx(O,{id:"name",value:i.name,onChange:s=>f({...i,name:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx(O,{id:"email",type:"email",value:i.email,onChange:s=>f({...i,email:s.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"phone",children:"Phone Number"}),e.jsx(O,{id:"phone",value:i.phoneNumber,onChange:s=>f({...i,phoneNumber:s.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx(O,{id:"password",type:"password",value:i.password,onChange:s=>f({...i,password:s.target.value}),placeholder:"Enter password"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"role",children:"Role"}),e.jsxs("select",{id:"role",value:i.role,onChange:s=>f({...i,role:s.target.value}),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"CLIENT",children:"Client"}),e.jsx("option",{value:"ADMIN",children:"Admin"}),e.jsx("option",{value:"SUPERADMIN",children:"SuperAdmin"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(C,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(C,{onClick:Se,disabled:T,children:T?"Creating...":"Add User"})]})]})]})]})]}),H&&e.jsx(os,{message:H,onRetry:()=>w(n,a)}),e.jsx(Be,{children:e.jsx(Je,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Registered"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Bookings"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-8",children:e.jsx(ns,{className:"h-8 w-full"})})}):z.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):z.map(s=>{var t;return e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap font-semibold",children:s.name}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s.email}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s.phoneNumber}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:e.jsxs(ls,{className:Fe(s.role),children:[Re(s.role),e.jsx("span",{className:"ml-1",children:s.role})]})}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:re(new Date(s.createdAt),"yyyy-MM-dd")}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:((t=s._count)==null?void 0:t.bookings)??0}),e.jsxs("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap flex gap-4 items-center",children:[e.jsx(C,{size:"sm",variant:"outline",onClick:()=>Le(s),"aria-label":`View tickets for ${s.name}`,children:e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsxs("span",{children:[e.jsx(_e,{className:"h-4 w-4 mr-1"})," Tickets"]})}),e.jsx(g,{children:"View all tickets for this user"})]})})}),e.jsx(C,{size:"sm",variant:"outline",onClick:()=>ke(s),"aria-label":`Edit user ${s.name}`,children:e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("span",{children:e.jsx(qe,{className:"h-4 w-4"})})}),e.jsx(g,{children:"Edit user"})]})})}),e.jsx(C,{size:"sm",variant:"destructive",onClick:()=>Ue(s.id),"aria-label":`Delete user ${s.name}`,children:e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("span",{children:e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(g,{children:"Delete user"})]})})})]})]},s.id)})})]})})})}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(C,{size:"sm",variant:"outline",disabled:n===1,onClick:()=>S(n-1),children:"Previous"}),e.jsxs("span",{className:"px-2 py-1",children:["Page ",n," of ",D]}),e.jsx(C,{size:"sm",variant:"outline",disabled:n===D,onClick:()=>S(n+1),children:"Next"})]}),e.jsx(We,{open:K,onOpenChange:A,children:e.jsxs(Ze,{children:[e.jsxs(Ye,{children:[e.jsx(es,{children:"Confirm Delete"}),e.jsx(ss,{children:"Are you sure you want to delete this user? This action cannot be undone and will remove all user data from the system."})]}),e.jsxs(ts,{children:[e.jsx(as,{children:"Cancel"}),e.jsx(rs,{onClick:Ae,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})}),e.jsx(ie,{open:le,onOpenChange:q,children:e.jsxs(de,{className:"sm:max-w-[425px]",children:[e.jsx(ce,{children:e.jsx(he,{children:"Edit User"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-name",children:"Name"}),e.jsx(O,{id:"edit-name",value:c.name,onChange:s=>m({...c,name:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-email",children:"Email"}),e.jsx(O,{id:"edit-email",type:"email",value:c.email,onChange:s=>m({...c,email:s.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-phone",children:"Phone Number"}),e.jsx(O,{id:"edit-phone",value:c.phoneNumber,onChange:s=>m({...c,phoneNumber:s.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"edit-role",children:"Role"}),e.jsxs("select",{id:"edit-role",value:c.role,onChange:s=>m({...c,role:s.target.value}),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"SUPERADMIN",children:"SUPERADMIN"}),e.jsx("option",{value:"ADMIN",children:"ADMIN"}),e.jsx("option",{value:"CLIENT",children:"CLIENT"})]})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(C,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsx(C,{onClick:Me,disabled:N,children:N?"Saving...":"Save Changes"})]})]})}),e.jsx(ie,{open:Ne,onOpenChange:xe,children:e.jsxs(de,{className:"max-w-5xl",children:[e.jsx(ce,{children:e.jsxs(he,{children:["Tickets for ",V==null?void 0:V.name]})}),e.jsxs("div",{className:"flex flex-wrap gap-8 items-center mb-4",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Total Tickets: ",e.jsx("span",{className:"font-bold",children:Oe})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Total Revenue:"," ",e.jsxs("span",{className:"font-bold",children:["₨",He]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Most Used Route:"," ",e.jsx("span",{className:"font-bold",children:$e})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-end mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Date From"}),e.jsx("input",{type:"date",name:"dateFrom",value:U.dateFrom,onChange:oe,className:"border rounded px-2 py-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Date To"}),e.jsx("input",{type:"date",name:"dateTo",value:U.dateTo,onChange:oe,className:"border rounded px-2 py-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:U.status,onChange:oe,className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"BOOKED",children:"BOOKED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"}),e.jsx("option",{value:"COMPLETED",children:"COMPLETED"})]})]}),e.jsx(C,{size:"sm",variant:"outline",onClick:Ie,children:"Export CSV"})]}),ve?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):M.length===0?e.jsx("div",{className:"p-8 text-center",children:"No tickets found."}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Ticket #"})}),e.jsx(g,{children:"Unique ticket number"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"QR"})}),e.jsx(g,{children:"QR code for ticket"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Booking Date"})}),e.jsx(g,{children:"Date/time ticket was booked"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Status"})}),e.jsx(g,{children:"Booking status"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Route"})}),e.jsx(g,{children:"Route of the trip"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Bus"})}),e.jsx(g,{children:"Bus name"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Seat"})}),e.jsx(g,{children:"Seat number"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Client"})}),e.jsx(g,{children:"Client name"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Amount"})}),e.jsx(g,{children:"Payment amount"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Method"})}),e.jsx(g,{children:"Payment method"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Txn ID"})}),e.jsx(g,{children:"Transaction ID"})]})}),e.jsx(u,{children:e.jsxs(p,{children:[e.jsx(j,{asChild:!0,children:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Cancelled At"})}),e.jsx(g,{children:"Cancellation date/time"})]})})]})}),e.jsx("tbody",{children:Pe.map(s=>{var y,h,v,P,I,X,B,J;const t=s.bookings[0],b=(y=s.bookings)==null?void 0:y.map(ae=>{var W;return(W=ae.seat)==null?void 0:W.seatNumber}).filter(Boolean).join(", ");return e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap font-mono",children:s.ticketNumber}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:s.qrCode?e.jsx("img",{src:s.qrCode,alt:"QR",className:"h-8 w-8 object-contain"}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"-"})}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t!=null&&t.createdAt?re(new Date(t.createdAt),"yyyy-MM-dd HH:mm"):"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t==null?void 0:t.status}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:(h=t==null?void 0:t.schedule)!=null&&h.route?`${t.schedule.route.origin} → ${t.schedule.route.destination}`:"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:((P=(v=t==null?void 0:t.schedule)==null?void 0:v.bus)==null?void 0:P.name)||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:b||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:((I=t==null?void 0:t.user)==null?void 0:I.name)||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:(X=t==null?void 0:t.payment)!=null&&X.amount?`₨${t.payment.amount}`:"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:((B=t==null?void 0:t.payment)==null?void 0:B.method)||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap font-mono text-xs",children:((J=t==null?void 0:t.payment)==null?void 0:J.transactionId)||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:(t==null?void 0:t.status)==="CANCELLED"&&(t!=null&&t.deletedAt)?re(new Date(t.deletedAt),"yyyy-MM-dd HH:mm"):"-"})]},s.id)})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Showing ",(k-1)*G+1," -"," ",Math.min(k*G,M.length)," ","of ",M.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{size:"sm",variant:"outline",disabled:k===1,onClick:()=>ne(k-1),children:"Prev"}),e.jsxs("span",{className:"text-xs",children:["Page ",k," of ",pe]}),e.jsx(C,{size:"sm",variant:"outline",disabled:k===pe,onClick:()=>ne(k+1),children:"Next"})]})]})]})]})})]})})};export{Cs as default};
