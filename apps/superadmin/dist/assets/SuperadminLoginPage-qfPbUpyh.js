import{j as e,$ as Z,e as ee,K as V,a0 as se,a1 as ae,J as re,a2 as q,a3 as F,a4 as I,a5 as M,a6 as D,a7 as te}from"./ui-vendor-BPnJF_7J.js";import{r as d,f as le}from"./react-vendor-Bgq3EpD8.js";import{B as U}from"./badge-CVKJlgmv.js";import{c as R,u as _,R as ne,t as ie,B as u}from"./index-C5bx2-Fn.js";import{C as E,a as S,b as A,c as O,d as B}from"./card-CoINBLpb.js";import{I as b}from"./input-CM-I2g3X.js";import{a as g}from"./utils-vendor-Dq7h7Pqt.js";import"./query-vendor-B3bfG-l7.js";function y({className:h,...l}){return e.jsx(Z,{"data-slot":"label",className:R("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",h),...l})}const oe=ee("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function w({className:h,variant:l,...p}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:R(oe({variant:l}),h),...p})}function N({className:h,...l}){return e.jsx("div",{"data-slot":"alert-description",className:R("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",h),...l})}function ce(){const[h,l]=d.useState(!1),[p,n]=d.useState(null),{login:x}=_(),P=d.useCallback(async(m,o)=>{var t,c;l(!0),n(null);try{const a=await g.post("/api/auth/login",{email:m,password:o});return a.data.user&&a.data.user.role!=="SUPERADMIN"?(n("Access denied. Only superadmins can access this portal."),!1):a.data.token&&a.data.user?(x(a.data.token,a.data.user),!0):!1}catch(a){console.log("Login error:",a);let i="Login failed. Please try again.";return g.isAxiosError(a)&&((c=(t=a.response)==null?void 0:t.data)!=null&&c.message)?i=a.response.data.message:a instanceof Error&&(i=a.message),n(i),!1}finally{l(!1)}},[x]),r=d.useCallback(async m=>{var o,t;l(!0),n(null);try{return await g.post("/api/auth/send-otp",{email:m}),!0}catch(c){return g.isAxiosError(c)?n(((t=(o=c.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to send reset link"):n("An unknown error occurred"),!1}finally{l(!1)}},[]),C=d.useCallback(async(m,o)=>{var t,c;l(!0),n(null);try{return await g.post("/api/auth/verify-otp",{email:m,otp:o}),!0}catch(a){return g.isAxiosError(a)?n(((c=(t=a.response)==null?void 0:t.data)==null?void 0:c.message)||"Invalid OTP"):n("An unknown error occurred"),!1}finally{l(!1)}},[]),T=d.useCallback(async(m,o,t)=>{var c,a;l(!0),n(null);try{return await g.post("/api/auth/reset-password",{email:m,otp:o,newPassword:t}),!0}catch(i){return g.isAxiosError(i)?n(((a=(c=i.response)==null?void 0:c.data)==null?void 0:a.message)||"Failed to reset password"):n("An unknown error occurred"),!1}finally{l(!1)}},[]);return{loading:h,error:p,login:P,forgotPassword:r,verifyOTP:C,resetPassword:T}}function je(){const h=le(),{user:l}=_(),[p,n]=d.useState("login"),[x,P]=d.useState(!1),[r,C]=d.useState({email:"",password:"",resetEmail:"",otp:"",newPassword:"",confirmPassword:""}),[T,m]=d.useState(!1),[o,t]=d.useState(null),[c,a]=d.useState(!1),{loading:i,error:f,login:z,forgotPassword:W,verifyOTP:$,resetPassword:H}=ce();d.useEffect(()=>{c&&l&&h(ne.AdminDashboard)},[c,l,h]);const J=d.useCallback(ie((...s)=>{const j=s[0],L=s[1];if(t(null),!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(j)){t("Please enter a valid email address.");return}z(j,L).then(Y=>{Y&&a(!0)})},1e3),[z]),K=s=>{s.preventDefault(),!i&&J(r.email,r.password)},G=async s=>{s.preventDefault(),t(null),await W(r.resetEmail)&&(m(!0),n("otp"))},k=s=>{t(null),n(s)},Q=async s=>{s.preventDefault(),await $(r.resetEmail,r.otp)&&n("reset")},X=async s=>{if(s.preventDefault(),t(null),r.newPassword!==r.confirmPassword){t("Passwords do not match");return}await H(r.resetEmail,r.otp,r.newPassword)&&(n("login"),m(!1),C({...r,otp:"",newPassword:"",confirmPassword:""}))},v=(s,j)=>{C(L=>({...L,[s]:j})),(s==="newPassword"||s==="confirmPassword")&&o&&t(null),s==="email"&&o&&t(null)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-primary relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary to-primary/80"}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-center px-12 text-white",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(V,{className:"h-10 w-10"}),e.jsx("span",{className:"text-3xl font-bold",children:"BusBooking Pro"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Welcome to the Future of Bus Travel"}),e.jsx("p",{className:"text-xl text-primary-foreground/90 mb-8",children:"Connect with millions of travelers and manage bookings with our comprehensive platform."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Secure & Trusted"}),e.jsx("p",{className:"text-primary-foreground/80",children:"Bank-level security for all transactions"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(ae,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"24/7 Support"}),e.jsx("p",{className:"text-primary-foreground/80",children:"Round-the-clock customer assistance"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Trusted by Millions"}),e.jsx("p",{className:"text-primary-foreground/80",children:"Over 2M+ happy customers worldwide"})]})]})]}),e.jsxs("div",{className:"mt-12 flex items-center gap-4",children:[e.jsx(U,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:"⭐ 4.8/5 Rating"}),e.jsx(U,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:"🏆 Best Travel App 2024"})]})]}),e.jsx("div",{className:"absolute top-20 right-20 w-32 h-32 bg-white/10 rounded-full"}),e.jsx("div",{className:"absolute bottom-20 right-32 w-20 h-20 bg-white/10 rounded-full"}),e.jsx("div",{className:"absolute top-1/2 right-10 w-16 h-16 bg-white/10 rounded-full"})]}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"lg:hidden text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx(V,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"text-2xl font-bold",children:"BusBooking Pro"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Sign in to your account"})]}),p==="login"&&e.jsxs(E,{className:"shadow-lg border-0",children:[e.jsxs(S,{className:"text-center pb-4",children:[e.jsx(A,{className:"text-2xl font-bold",children:"Superadmin Login"}),e.jsx(O,{children:"Sign in to your superadmin account to continue"})]}),e.jsxs(B,{className:"space-y-6",children:[o&&e.jsx(w,{children:e.jsx(N,{children:o})}),f&&e.jsx(w,{children:e.jsx(N,{children:f})}),e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"email",type:"email",placeholder:"Enter your email",value:r.email,onChange:s=>v("email",s.target.value),className:"pl-10",required:!0})]})]}),e.jsx(y,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"password",type:x?"text":"password",placeholder:"Enter your password",value:r.password,onChange:s=>v("password",s.target.value),className:"pl-10 pr-10",required:!0}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>P(!x),children:x?e.jsx(I,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"})})]}),e.jsx(u,{type:"submit",className:"w-full",size:"lg",disabled:i,children:i?"Logging in...":"Login"})]})]})]}),p==="forgot"&&e.jsxs(E,{className:"shadow-lg border-0",children:[e.jsxs(S,{className:"text-center pb-4",children:[e.jsxs(u,{variant:"ghost",size:"sm",className:"absolute left-4 top-4",onClick:()=>k("login"),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(A,{className:"text-2xl font-bold",children:"Forgot Password?"}),e.jsx(O,{children:"No worries! Enter your email and we'll send you a reset link."})]}),e.jsxs(B,{className:"space-y-6",children:[f&&e.jsx(w,{children:e.jsx(N,{children:f})}),T?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(te,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Check your email"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["We've sent a password reset link to"," ",r.resetEmail]}),e.jsx(w,{children:e.jsxs(N,{children:["Didn't receive the email? Check your spam folder or"," ",e.jsx(u,{variant:"link",className:"px-0 h-auto text-primary",onClick:()=>m(!1),children:"try again"})]})})]}),e.jsx(u,{variant:"outline",className:"w-full",onClick:()=>k("otp"),children:"I have the reset code"})]}):e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"resetEmail",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"resetEmail",type:"email",placeholder:"Enter your email",value:r.resetEmail,onChange:s=>v("resetEmail",s.target.value),className:"pl-10",required:!0})]})]}),e.jsx(u,{type:"submit",className:"w-full",size:"lg",disabled:i,children:i?"Sending...":"Send OTP"})]})]})]}),p==="otp"&&e.jsxs(E,{className:"shadow-lg border-0",children:[e.jsxs(S,{className:"text-center pb-4",children:[e.jsxs(u,{variant:"ghost",size:"sm",className:"absolute left-4 top-4",onClick:()=>k("forgot"),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(A,{className:"text-2xl font-bold",children:"Enter OTP"}),e.jsx(O,{children:"Check your email for the OTP code."})]}),e.jsxs(B,{className:"space-y-6",children:[f&&e.jsx(w,{children:e.jsx(N,{children:f})}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"otp",children:"OTP Code"}),e.jsx("div",{className:"relative",children:e.jsx(b,{id:"otp",type:"text",placeholder:"Enter OTP code",value:r.otp,onChange:s=>v("otp",s.target.value),className:"pl-10",required:!0})})]}),e.jsx(u,{type:"submit",className:"w-full",size:"lg",disabled:i,children:i?"Verifying...":"Verify OTP"})]})]})]}),p==="reset"&&e.jsxs(E,{className:"shadow-lg border-0",children:[e.jsxs(S,{className:"text-center pb-4",children:[e.jsxs(u,{variant:"ghost",size:"sm",className:"absolute left-4 top-4",onClick:()=>k("otp"),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(A,{className:"text-2xl font-bold",children:"Reset Password"}),e.jsx(O,{children:"Enter your new password below"})]}),e.jsxs(B,{className:"space-y-6",children:[o&&e.jsx(w,{children:e.jsx(N,{children:o})}),f&&e.jsx(w,{children:e.jsx(N,{children:f})}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsx(y,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"newPassword",type:x?"text":"password",placeholder:"Enter new password",value:r.newPassword,onChange:s=>v("newPassword",s.target.value),className:"pl-10 pr-10",required:!0}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>P(!x),children:x?e.jsx(I,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"})})]}),e.jsx(y,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(b,{id:"confirmPassword",type:"password",placeholder:"Confirm new password",value:r.confirmPassword,onChange:s=>v("confirmPassword",s.target.value),className:"pl-10",required:!0})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"mb-2",children:"Password must contain:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"• At least 8 characters"}),e.jsx("li",{children:"• One uppercase letter"}),e.jsx("li",{children:"• One lowercase letter"}),e.jsx("li",{children:"• One number"})]})]}),e.jsx(u,{type:"submit",className:"w-full",size:"lg",disabled:i,children:i?"Resetting...":"Reset Password"})]})]})]})]})})]})}export{je as SuperadminLoginPage};
