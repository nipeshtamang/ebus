import{ag as B,j as e,ai as St,aj as Ct,ak as Rt,al as kt}from"./ui-vendor-Dho0S5x9.js";import{a as n}from"./react-vendor-ByNQKlCH.js";import{C as H,a as V,b as Y,d as G}from"./card-C7BQZI4A.js";import{c as ne,B as j,T as Bt,a as nt,b as dt,d as it,A as Ae,e as Fe,f as Ee,g as Le,i as $e,j as Oe,k as _e}from"./index-DMYsCFYG.js";import{T as Me}from"./table-DNDMFJuf.js";import{S as Pe}from"./skeleton-XnDLFZGi.js";import{f as C,s as Dt}from"./superadminApi-Bjf7uKUS.js";import{D as ze,b as qe,c as He,d as Ve,e as Ye}from"./dialog-A3DPpc4l.js";import"./query-vendor-Br3W6GMP.js";import"./utils-vendor-Dq7h7Pqt.js";function It(){const[p,c]=n.useState([]),[O,y]=n.useState([]),[J,R]=n.useState([]),[de,m]=n.useState(!1),[U,D]=n.useState(null),[ie,W]=n.useState(!1),[oe,K]=n.useState(!1),[ce,X]=n.useState(!1),[ue,u]=n.useState(null),T=n.useRef({buses:[],routes:[],schedules:[]}),o=n.useCallback((a,r)=>{const d=a instanceof Error?a.message:`Failed to ${r}`;D(d),B.error(d),console.error(`Error in ${r}:`,a)},[]),h=n.useCallback(a=>{D(null),B.success(a)},[]),Q=n.useCallback(async()=>{W(!0),D(null);try{const a=await C.getAllBuses();T.current.buses=a.data,c(a.data)}catch(a){o(a,"load buses")}finally{W(!1)}},[o]),he=n.useCallback(async a=>{u("createBus");try{const r={id:Date.now(),name:a.name,layoutType:a.layoutType,seatCount:a.seatCount,schedules:[]};c(l=>[...l,r]);const d=await C.createBus(a);c(l=>l.map(i=>i.id===r.id?d.data:i)),h("Bus created successfully!")}catch(r){throw c(d=>d.filter(l=>l.id!==Date.now())),o(r,"create bus"),r}finally{u(null)}},[o,h]),_=n.useCallback(async(a,r)=>{u(`updateBus_${a}`);try{c(l=>l.map(i=>i.id===a?{...i,...r}:i));const d=await C.updateBus(a,r);c(l=>l.map(i=>i.id===a?d.data:i)),h("Bus updated successfully!")}catch(d){throw c(l=>l.map(i=>i.id===a&&T.current.buses.find(k=>k.id===a)||i)),o(d,"update bus"),d}finally{u(null)}},[o,h]),Z=n.useCallback(async a=>{u(`deleteBus_${a}`);try{c(r=>r.filter(d=>d.id!==a)),await C.deleteBus(a),h("Bus deleted successfully!")}catch(r){const d=p.find(l=>l.id===a);throw d&&c(l=>[...l,d]),o(r,"delete bus"),r}finally{u(null)}},[p,o,h]),w=n.useCallback(async()=>{K(!0),D(null);try{const a=await C.getAllRoutes();T.current.routes=a.data,y(a.data)}catch(a){o(a,"load routes")}finally{K(!1)}},[o]),M=n.useCallback(async a=>{u("createRoute");try{const r={id:Date.now(),name:a.name,origin:a.origin,destination:a.destination};y(l=>[...l,r]);const d=await C.createRoute(a);y(l=>l.map(i=>i.id===r.id?d.data:i)),h("Route created successfully!")}catch(r){throw y(d=>d.filter(l=>l.id!==Date.now())),o(r,"create route"),r}finally{u(null)}},[o,h]),P=n.useCallback(async(a,r)=>{u(`updateRoute_${a}`);try{y(l=>l.map(i=>i.id===a?{...i,...r}:i));const d=await C.updateRoute(a,r);y(l=>l.map(i=>i.id===a?d.data:i)),h("Route updated successfully!")}catch(d){throw y(l=>l.map(i=>i.id===a&&T.current.routes.find(k=>k.id===a)||i)),o(d,"update route"),d}finally{u(null)}},[o,h]),ee=n.useCallback(async a=>{u(`deleteRoute_${a}`);try{y(r=>r.filter(d=>d.id!==a)),await C.deleteRoute(a),h("Route deleted successfully!")}catch(r){const d=O.find(l=>l.id===a);throw d&&y(l=>[...l,d]),o(r,"delete route"),r}finally{u(null)}},[O,o,h]),v=n.useCallback(async()=>{X(!0),D(null);try{const a=await C.getAllSchedules();T.current.schedules=a.data,R(a.data)}catch(a){o(a,"load schedules")}finally{X(!1)}},[o]),z=n.useCallback(async a=>{u("createSchedule");try{console.log("Creating schedule with data:",a);const r={id:Date.now(),...a};R(l=>[...l,r]);const d=await C.createSchedule(a);console.log("Schedule creation response:",d),R(l=>l.map(i=>i.id===r.id?d.data:i)),h("Schedule created successfully!")}catch(r){throw console.error("Schedule creation error details:",{error:r,response:r?.response?.data,status:r?.response?.status,message:r?.message}),R(d=>d.filter(l=>l.id!==Date.now())),o(r,"create schedule"),r}finally{u(null)}},[o,h]),xe=n.useCallback(async(a,r)=>{u(`updateSchedule_${a}`);try{R(l=>l.map(i=>i.id===a?{...i,...r}:i));const d=await C.updateSchedule(a,r);R(l=>l.map(i=>i.id===a?d.data:i)),h("Schedule updated successfully!")}catch(d){throw R(l=>l.map(i=>i.id===a&&T.current.schedules.find(k=>k.id===a)||i)),o(d,"update schedule"),d}finally{u(null)}},[o,h]),me=n.useCallback(async a=>{u(`deleteSchedule_${a}`);try{R(r=>r.filter(d=>d.id!==a)),await C.deleteSchedule(a),h("Schedule deleted successfully!")}catch(r){const d=J.find(l=>l.id===a);throw d&&R(l=>[...l,d]),o(r,"delete schedule"),r}finally{u(null)}},[J,o,h]),te=n.useCallback(async()=>{m(!0);try{await Promise.all([Q(),w(),v()]),h("Data refreshed successfully!")}catch(a){o(a,"refresh data")}finally{m(!1)}},[Q,w,v,o,h]);return{buses:p,routes:O,schedules:J,loading:de,busesLoading:ie,routesLoading:oe,schedulesLoading:ce,operationLoading:ue,error:U,fetchBuses:Q,createBus:he,updateBus:_,deleteBus:Z,fetchRoutes:w,createRoute:M,updateRoute:P,deleteRoute:ee,fetchSchedules:v,createSchedule:z,updateSchedule:xe,deleteSchedule:me,refreshAll:te,clearError:()=>D(null)}}function Tt({className:p,...c}){return e.jsx(St,{"data-slot":"tabs",className:ne("flex flex-col gap-2",p),...c})}function At({className:p,...c}){return e.jsx(Ct,{"data-slot":"tabs-list",className:ne("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",p),...c})}function Ge({className:p,...c}){return e.jsx(Rt,{"data-slot":"tabs-trigger",className:ne("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",p),...c})}function Je({className:p,...c}){return e.jsx(kt,{"data-slot":"tabs-content",className:ne("flex-1 outline-none",p),...c})}const Ht=()=>{const{buses:p,routes:c,schedules:O,loading:y,busesLoading:J,routesLoading:R,schedulesLoading:de,operationLoading:m,error:U,fetchBuses:D,createBus:ie,updateBus:W,deleteBus:oe,fetchRoutes:K,createRoute:ce,updateRoute:X,deleteRoute:ue,fetchSchedules:u,createSchedule:T,updateSchedule:o,deleteSchedule:h,refreshAll:Q,clearError:he}=It(),[_,Z]=n.useState(!1),[w,M]=n.useState({name:"",layoutType:"Standard",seatCount:40}),[P,ee]=n.useState(!1),[v,z]=n.useState({name:"",origin:"",destination:""}),[xe,me]=n.useState("buses"),[te,a]=n.useState(!1),[r,d]=n.useState({routeId:0,busId:0,departure:"",fare:0,isReturn:!1}),[l,i]=n.useState(null),[k,pe]=n.useState(null),[b,q]=n.useState(null),[se,ge]=n.useState(null),[F,E]=n.useState(null),[L,$]=n.useState(null),[N,ae]=n.useState({}),[S,re]=n.useState({}),[x,I]=n.useState({}),[g,A]=n.useState(null),[le,je]=n.useState(null),[fe,Ke]=n.useState(""),[be,Qe]=n.useState(""),[ye,Ue]=n.useState(""),[we,We]=n.useState(""),[ve,Xe]=n.useState(""),[Ne,Ze]=n.useState(""),[Se,et]=n.useState(""),[Ce,tt]=n.useState(""),[Re,st]=n.useState(""),[ke,at]=n.useState("");n.useEffect(()=>{D(),K(),u()},[D,K,u]);const rt=t=>{const s={};return t.name.trim()||(s.name="Name is required."),t.layoutType.trim()||(s.layoutType="Layout type is required."),(!t.seatCount||t.seatCount<=0)&&(s.seatCount="Seat count must be positive."),s},lt=t=>{const s={};return t.name.trim()||(s.name="Name is required."),t.origin.trim()||(s.origin="Origin is required."),t.destination.trim()||(s.destination="Destination is required."),s},Be=t=>{const s={};return(!t.routeId||t.routeId<=0)&&(s.routeId="Route is required."),(!t.busId||t.busId<=0)&&(s.busId="Bus is required."),t.departure||(s.departure="Departure is required."),(!t.fare||t.fare<=0)&&(s.fare="Fare must be positive."),s},ot=()=>{const t=Be(r);return Object.keys(t).length===0},ct=async()=>{const t=rt(w);if(ae(t),Object.keys(t).length>0){B.error("Please fix the errors in the form.");return}try{await ie(w),Z(!1),M({name:"",layoutType:"Standard",seatCount:40}),ae({})}catch{}},ut=async()=>{const t=lt(v);if(re(t),Object.keys(t).length>0){B.error("Please fix the errors in the form.");return}try{await ce(v),ee(!1),z({name:"",origin:"",destination:""}),re({})}catch{}},ht=async()=>{const t=Be(r);if(I(t),Object.keys(t).length>0){B.error("Please fix the errors in the form.");return}console.log("Creating schedule with data:",r);const s={...r,departure:new Date(r.departure).toISOString()};console.log("Converted schedule data:",s);try{await T(s),a(!1),d({routeId:0,busId:0,departure:"",fare:0,isReturn:!1}),I({})}catch(f){console.error("Schedule creation error:",f)}},xt=t=>{i({name:t.name,layoutType:t.layoutType,seatCount:t.seatCount}),pe(t.id)},mt=t=>{q({name:t.name,origin:t.origin,destination:t.destination}),ge(t.id)},pt=t=>{A({routeId:t.routeId,busId:t.busId,departure:t.departure,fare:t.fare,isReturn:t.isReturn}),je(t.id)},gt=async()=>{if(!l)return;const t=rt(l);if(ae(t),Object.keys(t).length>0){B.error("Please fix the errors in the form.");return}try{await W(k,l),i(null),pe(null),ae({})}catch{}},jt=async()=>{if(!b)return;const t=lt(b);if(re(t),Object.keys(t).length>0){B.error("Please fix the errors in the form.");return}try{await X(se,b),q(null),ge(null),re({})}catch{}},ft=async()=>{if(!g)return;const t=Be(g);if(I(t),Object.keys(t).length>0){B.error("Please fix the errors in the form.");return}const s={...g,departure:new Date(g.departure).toISOString()};try{await o(le,s),A(null),je(null),I({})}catch(f){console.error("Schedule update error:",f)}},De=async()=>{if(!(!L||!F))try{F==="bus"?await oe(L):F==="route"?await ue(L):F==="schedule"&&await h(L),E(null),$(null)}catch{}},bt=async t=>{try{await Dt.regenerateSeats(t),await u(),B.success("Seats regenerated successfully!")}catch(s){console.error("Error regenerating seats:",s),B.error("Failed to regenerate seats. Please check if there are any existing bookings.")}},yt=p.filter(t=>{const s=!fe||t.layoutType===fe,f=be===""||t.seatCount>=Number(be),Ie=ye===""||t.seatCount<=Number(ye),Te=!we||t.schedules.some(Nt=>Nt.route?.id?.toString()===we);return s&&f&&Ie&&Te}),wt=c.filter(t=>{const s=!ve||t.origin===ve,f=!Ne||t.destination===Ne;return s&&f}),vt=O.filter(t=>{const s=!Se||t.routeId.toString()===Se,f=!Ce||t.busId.toString()===Ce,Ie=!Re||t.departure.slice(0,10)===Re,Te=!ke||(ke==="return"?t.isReturn:!t.isReturn);return s&&f&&Ie&&Te});return e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-white to-teal-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Fleet Management"}),U&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-red-600 font-medium",children:"Error:"}),e.jsx("span",{className:"text-red-700",children:U}),e.jsx("button",{onClick:he,className:"ml-auto text-red-500 hover:text-red-700",children:"✕"})]})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap w-full sm:w-auto",children:[e.jsxs(j,{onClick:Q,disabled:y,variant:"outline",className:"flex items-center gap-2 w-full sm:w-auto",children:[y?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}):e.jsx("span",{children:"↻"}),"Refresh"]}),e.jsxs(Bt,{children:[e.jsxs(nt,{children:[e.jsx(dt,{asChild:!0,children:e.jsx(j,{onClick:()=>Z(t=>!t),"aria-label":_?"Cancel add bus":"Add new bus",className:"w-full sm:w-auto",children:_?"Cancel":"Add Bus"})}),e.jsx(it,{children:_?"Cancel adding a new bus":"Add a new bus to the fleet"})]}),e.jsxs(nt,{children:[e.jsx(dt,{asChild:!0,children:e.jsx(j,{onClick:()=>ee(t=>!t),"aria-label":P?"Cancel add route":"Add new route",className:"w-full sm:w-auto",children:P?"Cancel":"Add Route"})}),e.jsx(it,{children:P?"Cancel adding a new route":"Add a new route"})]})]})]})]}),e.jsxs(Tt,{value:xe,onValueChange:me,className:"w-full",children:[e.jsxs(At,{className:"mb-4",children:[e.jsx(Ge,{value:"buses",children:"Buses"}),e.jsx(Ge,{value:"routes",children:"Routes"}),e.jsx(Ge,{value:"schedules",children:"Schedules"})]}),e.jsxs(Je,{value:"buses",children:[_&&e.jsxs(H,{className:"mb-4 transition-all duration-300 ease-in-out",children:[e.jsx(V,{children:e.jsx(Y,{children:"Add New Bus"})}),e.jsx(G,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 items-stretch md:items-center",children:[e.jsx("input",{className:"border rounded px-2 py-1 flex-1 min-w-0",placeholder:"Bus Name","aria-label":"Bus Name",value:w.name,onChange:t=>M({...w,name:t.target.value})}),N.name&&e.jsx("div",{className:"text-xs text-red-500",children:N.name}),e.jsxs("select",{className:"border rounded px-2 py-1 flex-1 min-w-0",value:w.layoutType,onChange:t=>M({...w,layoutType:t.target.value}),children:[e.jsx("option",{value:"",children:"Select Layout Type"}),e.jsx("option",{value:"1/2",children:"1/2 (1 Left, 2 Right)"}),e.jsx("option",{value:"2/1",children:"2/1 (2 Left, 1 Right)"}),e.jsx("option",{value:"2/2",children:"2/2 (2 Left, 2 Right)"}),e.jsx("option",{value:"3/2",children:"3/2 (3 Left, 2 Right)"}),e.jsx("option",{value:"4/2",children:"4/2 (4 Left, 2 Right)"})]}),N.layoutType&&e.jsx("div",{className:"text-xs text-red-500",children:N.layoutType}),e.jsx("input",{className:"border rounded px-2 py-1 w-24 flex-shrink-0",type:"number",placeholder:"Seat Count","aria-label":"Seat Count",value:w.seatCount,onChange:t=>M({...w,seatCount:Number(t.target.value)})}),N.seatCount&&e.jsx("div",{className:"text-xs text-red-500",children:N.seatCount}),e.jsxs(j,{onClick:ct,"aria-label":"Confirm add bus",disabled:m==="createBus",children:[m==="createBus"?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mr-2"}):null," ","Add"]}),e.jsx("div",{className:"text-xs text-muted-foreground ml-2 mt-2 md:mt-0",children:"Enter bus name, layout type, and seat count"})]})})]}),e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(Y,{children:"Fleets"})}),e.jsx(G,{children:J?e.jsx(Pe,{className:"h-8 w-full"}):p.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No buses found"}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[e.jsxs("select",{value:fe,onChange:t=>Ke(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Layouts"}),[...new Set(p.map(t=>t.layoutType))].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("input",{type:"number",value:be,onChange:t=>Qe(t.target.value?Number(t.target.value):""),placeholder:"Min Seats",className:"border rounded px-2 py-1 w-24"}),e.jsx("input",{type:"number",value:ye,onChange:t=>Ue(t.target.value?Number(t.target.value):""),placeholder:"Max Seats",className:"border rounded px-2 py-1 w-24"}),e.jsxs("select",{value:we,onChange:t=>We(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Routes"}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.origin," - ",t.destination,")"]},t.id))]}),e.jsx(j,{onClick:()=>{Ke(""),Qe(""),Ue(""),We("")},children:"Clear"})]}),e.jsxs(Me,{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Layout"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Seat Count"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Routes"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:yt.map(t=>e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.layoutType}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.seatCount}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.schedules.map(s=>s.route?.name||`${s.route?.origin} - ${s.route?.destination}`).filter(Boolean).join(", ")||"-"}),e.jsxs("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap flex gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",className:"mr-2",onClick:()=>xt(t),"aria-label":`Edit bus ${t.name}`,children:e.jsx("span",{children:"Edit"})}),e.jsx(ze,{open:!!l&&k===t.id,onOpenChange:s=>{s||(i(null),pe(null))},children:e.jsxs(qe,{children:[e.jsx(He,{children:e.jsx(Ve,{children:"Edit Bus"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{className:"border rounded px-2 py-1",placeholder:"Bus Name",value:l?.name||"",onChange:s=>i(l?{...l,name:s.target.value}:null)}),N.name&&e.jsx("div",{className:"text-xs text-red-500",children:N.name}),e.jsxs("select",{className:"border rounded px-2 py-1",value:l?.layoutType||"",onChange:s=>i(l?{...l,layoutType:s.target.value}:null),children:[e.jsx("option",{value:"",children:"Select Layout Type"}),e.jsx("option",{value:"1/2",children:"1/2 (1 Left, 2 Right)"}),e.jsx("option",{value:"2/1",children:"2/1 (2 Left, 1 Right)"}),e.jsx("option",{value:"2/2",children:"2/2 (2 Left, 2 Right)"}),e.jsx("option",{value:"3/2",children:"3/2 (3 Left, 2 Right)"}),e.jsx("option",{value:"4/2",children:"4/2 (4 Left, 2 Right)"})]}),N.layoutType&&e.jsx("div",{className:"text-xs text-red-500",children:N.layoutType}),e.jsx("input",{className:"border rounded px-2 py-1",type:"number",placeholder:"Seat Count",value:l?.seatCount||0,onChange:s=>i(l?{...l,seatCount:Number(s.target.value)}:null)}),N.seatCount&&e.jsx("div",{className:"text-xs text-red-500",children:N.seatCount})]}),e.jsx(Ye,{children:e.jsxs(j,{onClick:gt,disabled:m===`updateBus_${k}`,children:[m===`updateBus_${k}`?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mr-2"}):null," ","Save"]})})]})}),e.jsxs(j,{size:"sm",variant:"destructive",onClick:()=>{E("bus"),$(t.id)},disabled:m===`deleteBus_${t.id}`,"aria-label":`Delete bus ${t.name}`,children:[m===`deleteBus_${t.id}`?e.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-red-600 rounded-full animate-spin mr-1"}):null,e.jsx("span",{children:"Delete"})]}),e.jsx(Ae,{open:F==="bus"&&L===t.id,onOpenChange:s=>{s||(E(null),$(null))},children:e.jsxs(Fe,{children:[e.jsxs(Ee,{children:[e.jsx(Le,{children:"Delete Bus"}),e.jsx("p",{children:"Are you sure you want to delete this bus?"})]}),e.jsxs($e,{children:[e.jsx(Oe,{children:"Cancel"}),e.jsx(_e,{onClick:De,children:"Delete"})]})]})})]})]},t.id))})]})]})})]})]}),e.jsxs(Je,{value:"routes",children:[P&&e.jsxs(H,{className:"mb-4 transition-all duration-300 ease-in-out",children:[e.jsx(V,{children:e.jsx(Y,{children:"Add New Route"})}),e.jsx(G,{children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 items-stretch md:items-center",children:[e.jsx("input",{className:"border rounded px-2 py-1 flex-1 min-w-0",placeholder:"Route Name","aria-label":"Route Name",value:v.name,onChange:t=>z({...v,name:t.target.value})}),S.name&&e.jsx("div",{className:"text-xs text-red-500",children:S.name}),e.jsx("input",{className:"border rounded px-2 py-1 flex-1 min-w-0",placeholder:"Origin","aria-label":"Origin",value:v.origin,onChange:t=>z({...v,origin:t.target.value})}),S.origin&&e.jsx("div",{className:"text-xs text-red-500",children:S.origin}),e.jsx("input",{className:"border rounded px-2 py-1 flex-1 min-w-0",placeholder:"Destination","aria-label":"Destination",value:v.destination,onChange:t=>z({...v,destination:t.target.value})}),S.destination&&e.jsx("div",{className:"text-xs text-red-500",children:S.destination}),e.jsxs(j,{onClick:ut,"aria-label":"Confirm add route",disabled:m==="createRoute",children:[m==="createRoute"?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mr-2"}):null," ","Add"]}),e.jsx("div",{className:"text-xs text-muted-foreground ml-2 mt-2 md:mt-0",children:"Enter route name, origin, and destination"})]})})]}),e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(Y,{children:"Routes"})}),e.jsx(G,{children:R?e.jsx(Pe,{className:"h-8 w-full"}):c.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No routes found"}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[e.jsxs("select",{value:ve,onChange:t=>Xe(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Origins"}),[...new Set(c.map(t=>t.origin))].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:Ne,onChange:t=>Ze(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Destinations"}),[...new Set(c.map(t=>t.destination))].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx(j,{onClick:()=>{Xe(""),Ze("")},children:"Clear"})]}),e.jsxs(Me,{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Origin"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Destination"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:wt.map(t=>e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.name}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.origin}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.destination}),e.jsxs("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap flex gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",className:"mr-2",onClick:()=>mt(t),"aria-label":`Edit route ${t.name}`,children:e.jsx("span",{children:"Edit"})}),e.jsx(ze,{open:!!b&&se===t.id,onOpenChange:s=>{s||(q(null),ge(null))},children:e.jsxs(qe,{children:[e.jsx(He,{children:e.jsx(Ve,{children:"Edit Route"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{className:"border rounded px-2 py-1",placeholder:"Route Name",value:b?.name||"",onChange:s=>q(b?{...b,name:s.target.value}:null)}),S.name&&e.jsx("div",{className:"text-xs text-red-500",children:S.name}),e.jsx("input",{className:"border rounded px-2 py-1",placeholder:"Origin",value:b?.origin||"",onChange:s=>q(b?{...b,origin:s.target.value}:null)}),S.origin&&e.jsx("div",{className:"text-xs text-red-500",children:S.origin}),e.jsx("input",{className:"border rounded px-2 py-1",placeholder:"Destination",value:b?.destination||"",onChange:s=>q(b?{...b,destination:s.target.value}:null)}),S.destination&&e.jsx("div",{className:"text-xs text-red-500",children:S.destination})]}),e.jsx(Ye,{children:e.jsxs(j,{onClick:jt,disabled:m===`updateRoute_${se}`,children:[m===`updateRoute_${se}`?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mr-2"}):null," ","Save"]})})]})}),e.jsxs(j,{size:"sm",variant:"destructive",onClick:()=>{E("route"),$(t.id)},disabled:m===`deleteRoute_${t.id}`,"aria-label":`Delete route ${t.name}`,children:[m===`deleteRoute_${t.id}`?e.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-red-600 rounded-full animate-spin mr-1"}):null,e.jsx("span",{children:"Delete"})]}),e.jsx(Ae,{open:F==="route"&&L===t.id,onOpenChange:s=>{s||(E(null),$(null))},children:e.jsxs(Fe,{children:[e.jsxs(Ee,{children:[e.jsx(Le,{children:"Delete Route"}),e.jsx("p",{children:"Are you sure you want to delete this route?"})]}),e.jsxs($e,{children:[e.jsx(Oe,{children:"Cancel"}),e.jsx(_e,{onClick:De,children:"Delete"})]})]})})]})]},t.id))})]})]})})]})]}),e.jsxs(Je,{value:"schedules",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Schedules"}),e.jsx(j,{onClick:()=>a(t=>!t),children:te?"Cancel":"Add Schedule"})]}),te&&e.jsxs(H,{className:"mb-4 transition-all duration-300 ease-in-out",children:[e.jsx(V,{children:e.jsx(Y,{children:"Add New Schedule"})}),e.jsx(G,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Route"}),e.jsxs("select",{className:`border rounded px-3 py-2 w-full ${x.routeId?"border-red-500":"border-gray-300"}`,value:r.routeId,onChange:t=>{const s=Number(t.target.value);d({...r,routeId:s}),s>0&&I(f=>({...f,routeId:void 0}))},children:[e.jsx("option",{value:0,children:"Select Route"}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.origin," - ",t.destination,")"]},t.id))]}),x.routeId&&e.jsx("div",{className:"text-sm text-red-600 font-medium",children:x.routeId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Bus"}),e.jsxs("select",{className:`border rounded px-3 py-2 w-full ${x.busId?"border-red-500":"border-gray-300"}`,value:r.busId,onChange:t=>{const s=Number(t.target.value);d({...r,busId:s}),s>0&&I(f=>({...f,busId:void 0}))},children:[e.jsx("option",{value:0,children:"Select Bus"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),x.busId&&e.jsx("div",{className:"text-sm text-red-600 font-medium",children:x.busId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Departure"}),e.jsx("input",{className:`border rounded px-3 py-2 w-full ${x.departure?"border-red-500":"border-gray-300"}`,type:"datetime-local",value:r.departure,onChange:t=>{const s=t.target.value;d({...r,departure:s}),s&&I(f=>({...f,departure:void 0}))}}),x.departure&&e.jsx("div",{className:"text-sm text-red-600 font-medium",children:x.departure})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Fare"}),e.jsx("input",{className:`border rounded px-3 py-2 w-full ${x.fare?"border-red-500":"border-gray-300"}`,type:"number",placeholder:"Enter fare amount",value:r.fare,onChange:t=>{const s=Number(t.target.value);d({...r,fare:s}),s>0&&I(f=>({...f,fare:void 0}))}}),x.fare&&e.jsx("div",{className:"text-sm text-red-600 font-medium",children:x.fare})]}),e.jsx("div",{className:"space-y-2 flex items-center",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:r.isReturn,onChange:t=>d({...r,isReturn:t.target.checked}),className:"rounded border-gray-300"}),"Return Trip"]})}),e.jsx("div",{className:"space-y-2 flex items-end",children:e.jsxs(j,{onClick:ht,disabled:m==="createSchedule"||!ot(),className:"w-full",children:[m==="createSchedule"?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mr-2"}):null,"Add Schedule"]})})]}),Object.keys(x).length>0&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("div",{className:"text-sm text-red-700 font-medium mb-2",children:"Please fix the following errors:"}),e.jsx("ul",{className:"text-sm text-red-600 space-y-1",children:Object.entries(x).map(([t,s])=>e.jsxs("li",{children:["• ",s]},t))})]})]})})]}),e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(Y,{children:"Schedules"})}),e.jsx(G,{children:de?e.jsx(Pe,{className:"h-8 w-full"}):O.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No schedules found"}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[e.jsxs("select",{value:Se,onChange:t=>et(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Routes"}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.origin," - ",t.destination,")"]},t.id))]}),e.jsxs("select",{value:Ce,onChange:t=>tt(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Buses"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("input",{type:"date",value:Re,onChange:t=>st(t.target.value),className:"border rounded px-2 py-1"}),e.jsxs("select",{value:ke,onChange:t=>at(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"oneway",children:"One-way"})]}),e.jsx(j,{onClick:()=>{et(""),tt(""),st(""),at("")},children:"Clear"})]}),e.jsxs(Me,{className:"min-w-[900px] border-separate border-spacing-y-2 border-spacing-x-4 rounded-xl bg-white shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Route"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Bus"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Layout"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Departure"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Fare"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Return"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Actions"})]})}),e.jsx("tbody",{children:vt.map(t=>e.jsxs("tr",{className:"even:bg-gray-50 hover:bg-teal-50 transition-colors rounded-xl",children:[e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:c.find(s=>s.id===t.routeId)?.name||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:p.find(s=>s.id===t.busId)?.name||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:p.find(s=>s.id===t.busId)?.layoutType||"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.departure?new Date(t.departure).toLocaleString():"-"}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.fare}),e.jsx("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap",children:t.isReturn?"Yes":"No"}),e.jsxs("td",{className:"px-6 py-4 bg-white rounded-lg shadow-sm whitespace-nowrap flex gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",className:"mr-2",onClick:()=>pt(t),"aria-label":`Edit schedule ${t.id}`,children:e.jsx("span",{children:"Edit"})}),e.jsx(j,{size:"sm",variant:"outline",className:"mr-2",onClick:()=>bt(t.id),"aria-label":`Regenerate seats for schedule ${t.id}`,children:e.jsx("span",{children:"Regenerate Seats"})}),e.jsxs(j,{size:"sm",variant:"destructive",onClick:()=>{E("schedule"),$(t.id)},disabled:m===`deleteSchedule_${t.id}`,children:[m===`deleteSchedule_${t.id}`?e.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-red-600 rounded-full animate-spin mr-1"}):null,"Delete"]}),e.jsx(Ae,{open:F==="schedule"&&L===t.id,onOpenChange:s=>{s||(E(null),$(null))},children:e.jsxs(Fe,{children:[e.jsxs(Ee,{children:[e.jsx(Le,{children:"Delete Schedule"}),e.jsx("p",{children:"Are you sure you want to delete this schedule?"})]}),e.jsxs($e,{children:[e.jsx(Oe,{children:"Cancel"}),e.jsx(_e,{onClick:De,children:"Delete"})]})]})}),e.jsx(ze,{open:!!g&&le===t.id,onOpenChange:s=>{s||(A(null),je(null),I({}))},children:e.jsxs(qe,{children:[e.jsx(He,{children:e.jsx(Ve,{children:"Edit Schedule"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("select",{className:"border rounded px-2 py-1",value:g?.routeId||0,onChange:s=>A(g?{...g,routeId:Number(s.target.value)}:null),children:[e.jsx("option",{value:0,children:"Select Route"}),c.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.origin," -"," ",s.destination,")"]},s.id))]}),x.routeId&&e.jsx("div",{className:"text-xs text-red-500",children:x.routeId}),e.jsxs("select",{className:"border rounded px-2 py-1",value:g?.busId||0,onChange:s=>A(g?{...g,busId:Number(s.target.value)}:null),children:[e.jsx("option",{value:0,children:"Select Bus"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),x.busId&&e.jsx("div",{className:"text-xs text-red-500",children:x.busId}),e.jsx("input",{className:"border rounded px-2 py-1",type:"datetime-local",value:g?.departure||"",onChange:s=>A(g?{...g,departure:s.target.value}:null)}),x.departure&&e.jsx("div",{className:"text-xs text-red-500",children:x.departure}),e.jsx("input",{className:"border rounded px-2 py-1",type:"number",placeholder:"Fare",value:g?.fare||0,onChange:s=>A(g?{...g,fare:Number(s.target.value)}:null)}),x.fare&&e.jsx("div",{className:"text-xs text-red-500",children:x.fare}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"checkbox",checked:g?.isReturn||!1,onChange:s=>A(g?{...g,isReturn:s.target.checked}:null)}),"Return"]})]}),e.jsx(Ye,{children:e.jsxs(j,{onClick:ft,disabled:m===`updateSchedule_${le}`,children:[m===`updateSchedule_${le}`?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mr-2"}):null," ","Save"]})})]})})]})]},t.id))})]})]})})]})]})]})]})})};export{Ht as default};
