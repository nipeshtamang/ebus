import{j as e,$ as Z,e as ee,K as z,a0 as se,a1 as ae,J as re,a2 as V,a3 as L,a4 as q,a5 as I,a6 as F,a7 as te}from"./ui-vendor-Dho0S5x9.js";import{a as i,i as le}from"./react-vendor-ByNQKlCH.js";import{B as M}from"./badge-C0YrEax5.js";import{c as D,u as U,R as ne,t as ie,B as c}from"./index-DMYsCFYG.js";import{C as k,a as E,b as S,c as A,d as O}from"./card-C7BQZI4A.js";import{I as v}from"./input-DM7v_Vsi.js";import{a as f}from"./utils-vendor-Dq7h7Pqt.js";import"./query-vendor-Br3W6GMP.js";function b({className:d,...t}){return e.jsx(Z,{"data-slot":"label",className:D("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",d),...t})}const oe=ee("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function j({className:d,variant:t,...x}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:D(oe({variant:t}),d),...x})}function w({className:d,...t}){return e.jsx("div",{"data-slot":"alert-description",className:D("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",d),...t})}function ce(){const[d,t]=i.useState(!1),[x,l]=i.useState(null),{login:m}=U(),y=i.useCallback(async(o,n)=>{t(!0),l(null);try{const a=await f.post("/api/auth/login",{email:o,password:n});return a.data.user&&a.data.user.role!=="SUPERADMIN"?(l("Access denied. Only superadmins can access this portal."),!1):a.data.token&&a.data.user?(m(a.data.token,a.data.user),!0):!1}catch(a){console.log("Login error:",a);let u="Login failed. Please try again.";return f.isAxiosError(a)&&a.response?.data?.message?u=a.response.data.message:a instanceof Error&&(u=a.message),l(u),!1}finally{t(!1)}},[m]),r=i.useCallback(async o=>{t(!0),l(null);try{return await f.post("/api/auth/send-otp",{email:o}),!0}catch(n){return f.isAxiosError(n)?l(n.response?.data?.message||"Failed to send reset link"):l("An unknown error occurred"),!1}finally{t(!1)}},[]),P=i.useCallback(async(o,n)=>{t(!0),l(null);try{return await f.post("/api/auth/verify-otp",{email:o,otp:n}),!0}catch(a){return f.isAxiosError(a)?l(a.response?.data?.message||"Invalid OTP"):l("An unknown error occurred"),!1}finally{t(!1)}},[]),B=i.useCallback(async(o,n,a)=>{t(!0),l(null);try{return await f.post("/api/auth/reset-password",{email:o,otp:n,newPassword:a}),!0}catch(u){return f.isAxiosError(u)?l(u.response?.data?.message||"Failed to reset password"):l("An unknown error occurred"),!1}finally{t(!1)}},[]);return{loading:d,error:x,login:y,forgotPassword:r,verifyOTP:P,resetPassword:B}}function je(){const d=le(),{user:t}=U(),[x,l]=i.useState("login"),[m,y]=i.useState(!1),[r,P]=i.useState({email:"",password:"",resetEmail:"",otp:"",newPassword:"",confirmPassword:""}),[B,o]=i.useState(!1),[n,a]=i.useState(null),[u,_]=i.useState(!1),{loading:h,error:p,login:R,forgotPassword:W,verifyOTP:$,resetPassword:H}=ce();i.useEffect(()=>{u&&t&&d(ne.AdminDashboard)},[u,t,d]);const J=i.useCallback(ie((...s)=>{const g=s[0],T=s[1];if(a(null),!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(g)){a("Please enter a valid email address.");return}R(g,T).then(Y=>{Y&&_(!0)})},1e3),[R]),K=s=>{s.preventDefault(),!h&&J(r.email,r.password)},G=async s=>{s.preventDefault(),a(null),await W(r.resetEmail)&&(o(!0),l("otp"))},C=s=>{a(null),l(s)},Q=async s=>{s.preventDefault(),await $(r.resetEmail,r.otp)&&l("reset")},X=async s=>{if(s.preventDefault(),a(null),r.newPassword!==r.confirmPassword){a("Passwords do not match");return}await H(r.resetEmail,r.otp,r.newPassword)&&(l("login"),o(!1),P({...r,otp:"",newPassword:"",confirmPassword:""}))},N=(s,g)=>{P(T=>({...T,[s]:g})),(s==="newPassword"||s==="confirmPassword")&&n&&a(null),s==="email"&&n&&a(null)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-primary relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary to-primary/80"}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-center px-12 text-white",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(z,{className:"h-10 w-10"}),e.jsx("span",{className:"text-3xl font-bold",children:"BusBooking Pro"})]}),e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Welcome to the Future of Bus Travel"}),e.jsx("p",{className:"text-xl text-primary-foreground/90 mb-8",children:"Connect with millions of travelers and manage bookings with our comprehensive platform."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Secure & Trusted"}),e.jsx("p",{className:"text-primary-foreground/80",children:"Bank-level security for all transactions"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(ae,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"24/7 Support"}),e.jsx("p",{className:"text-primary-foreground/80",children:"Round-the-clock customer assistance"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Trusted by Millions"}),e.jsx("p",{className:"text-primary-foreground/80",children:"Over 2M+ happy customers worldwide"})]})]})]}),e.jsxs("div",{className:"mt-12 flex items-center gap-4",children:[e.jsx(M,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:"⭐ 4.8/5 Rating"}),e.jsx(M,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:"🏆 Best Travel App 2024"})]})]}),e.jsx("div",{className:"absolute top-20 right-20 w-32 h-32 bg-white/10 rounded-full"}),e.jsx("div",{className:"absolute bottom-20 right-32 w-20 h-20 bg-white/10 rounded-full"}),e.jsx("div",{className:"absolute top-1/2 right-10 w-16 h-16 bg-white/10 rounded-full"})]}),e.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"lg:hidden text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx(z,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"text-2xl font-bold",children:"BusBooking Pro"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Sign in to your account"})]}),x==="login"&&e.jsxs(k,{className:"shadow-lg border-0",children:[e.jsxs(E,{className:"text-center pb-4",children:[e.jsx(S,{className:"text-2xl font-bold",children:"Superadmin Login"}),e.jsx(A,{children:"Sign in to your superadmin account to continue"})]}),e.jsxs(O,{className:"space-y-6",children:[n&&e.jsx(j,{children:e.jsx(w,{children:n})}),p&&e.jsx(j,{children:e.jsx(w,{children:p})}),e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"email",type:"email",placeholder:"Enter your email",value:r.email,onChange:s=>N("email",s.target.value),className:"pl-10",required:!0})]})]}),e.jsx(b,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"password",type:m?"text":"password",placeholder:"Enter your password",value:r.password,onChange:s=>N("password",s.target.value),className:"pl-10 pr-10",required:!0}),e.jsx(c,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>y(!m),children:m?e.jsx(q,{className:"h-4 w-4"}):e.jsx(I,{className:"h-4 w-4"})})]}),e.jsx(c,{type:"submit",className:"w-full",size:"lg",disabled:h,children:h?"Logging in...":"Login"})]})]})]}),x==="forgot"&&e.jsxs(k,{className:"shadow-lg border-0",children:[e.jsxs(E,{className:"text-center pb-4",children:[e.jsxs(c,{variant:"ghost",size:"sm",className:"absolute left-4 top-4",onClick:()=>C("login"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(S,{className:"text-2xl font-bold",children:"Forgot Password?"}),e.jsx(A,{children:"No worries! Enter your email and we'll send you a reset link."})]}),e.jsxs(O,{className:"space-y-6",children:[p&&e.jsx(j,{children:e.jsx(w,{children:p})}),B?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(te,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Check your email"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["We've sent a password reset link to"," ",r.resetEmail]}),e.jsx(j,{children:e.jsxs(w,{children:["Didn't receive the email? Check your spam folder or"," ",e.jsx(c,{variant:"link",className:"px-0 h-auto text-primary",onClick:()=>o(!1),children:"try again"})]})})]}),e.jsx(c,{variant:"outline",className:"w-full",onClick:()=>C("otp"),children:"I have the reset code"})]}):e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"resetEmail",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"resetEmail",type:"email",placeholder:"Enter your email",value:r.resetEmail,onChange:s=>N("resetEmail",s.target.value),className:"pl-10",required:!0})]})]}),e.jsx(c,{type:"submit",className:"w-full",size:"lg",disabled:h,children:h?"Sending...":"Send OTP"})]})]})]}),x==="otp"&&e.jsxs(k,{className:"shadow-lg border-0",children:[e.jsxs(E,{className:"text-center pb-4",children:[e.jsxs(c,{variant:"ghost",size:"sm",className:"absolute left-4 top-4",onClick:()=>C("forgot"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(S,{className:"text-2xl font-bold",children:"Enter OTP"}),e.jsx(A,{children:"Check your email for the OTP code."})]}),e.jsxs(O,{className:"space-y-6",children:[p&&e.jsx(j,{children:e.jsx(w,{children:p})}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"otp",children:"OTP Code"}),e.jsx("div",{className:"relative",children:e.jsx(v,{id:"otp",type:"text",placeholder:"Enter OTP code",value:r.otp,onChange:s=>N("otp",s.target.value),className:"pl-10",required:!0})})]}),e.jsx(c,{type:"submit",className:"w-full",size:"lg",disabled:h,children:h?"Verifying...":"Verify OTP"})]})]})]}),x==="reset"&&e.jsxs(k,{className:"shadow-lg border-0",children:[e.jsxs(E,{className:"text-center pb-4",children:[e.jsxs(c,{variant:"ghost",size:"sm",className:"absolute left-4 top-4",onClick:()=>C("otp"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(S,{className:"text-2xl font-bold",children:"Reset Password"}),e.jsx(A,{children:"Enter your new password below"})]}),e.jsxs(O,{className:"space-y-6",children:[n&&e.jsx(j,{children:e.jsx(w,{children:n})}),p&&e.jsx(j,{children:e.jsx(w,{children:p})}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsx(b,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"newPassword",type:m?"text":"password",placeholder:"Enter new password",value:r.newPassword,onChange:s=>N("newPassword",s.target.value),className:"pl-10 pr-10",required:!0}),e.jsx(c,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>y(!m),children:m?e.jsx(q,{className:"h-4 w-4"}):e.jsx(I,{className:"h-4 w-4"})})]}),e.jsx(b,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(v,{id:"confirmPassword",type:"password",placeholder:"Confirm new password",value:r.confirmPassword,onChange:s=>N("confirmPassword",s.target.value),className:"pl-10",required:!0})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"mb-2",children:"Password must contain:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"• At least 8 characters"}),e.jsx("li",{children:"• One uppercase letter"}),e.jsx("li",{children:"• One lowercase letter"}),e.jsx("li",{children:"• One number"})]})]}),e.jsx(c,{type:"submit",className:"w-full",size:"lg",disabled:h,children:h?"Resetting...":"Reset Password"})]})]})]})]})})]})}export{je as SuperadminLoginPage};
