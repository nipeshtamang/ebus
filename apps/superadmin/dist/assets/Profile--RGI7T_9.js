import{j as e}from"./ui-vendor-BPnJF_7J.js";import{r as o}from"./react-vendor-Bgq3EpD8.js";import{C as E,a as T,b as A,d as U}from"./card-CoINBLpb.js";import{u as G,l as k,m as z,n as B,T as F,a as M,b as D,d as J,B as x}from"./index-C5bx2-Fn.js";import{I as C}from"./input-CM-I2g3X.js";import{s as L}from"./superadminApi-Bft6DRZm.js";import"./query-vendor-B3bfG-l7.js";import"./utils-vendor-Dq7h7Pqt.js";const X=()=>{var P;const{user:a,updateUser:y}=G(),[s,c]=o.useState({name:(a==null?void 0:a.name)||"",email:(a==null?void 0:a.email)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||"",profileImage:(a==null?void 0:a.profileImage)||""}),[d,f]=o.useState(!1),[h,u]=o.useState(!1),[j,i]=o.useState(null),[b,v]=o.useState(null);o.useEffect(()=>{a&&(c({name:a.name||"",email:a.email||"",phoneNumber:a.phoneNumber||"",profileImage:a.profileImage||""}),v(a.profileImage||null))},[a]);const I=t=>{var m;const r=(m=t.target.files)==null?void 0:m[0];if(r){if(r.size>2097152){i("Image size must be less than 2MB");return}if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(r.type)){i("Please upload a valid image file (JPG, PNG, or WebP)");return}const n=new FileReader;n.onloadend=()=>{const l=n.result;v(l),c(S=>({...S,profileImage:l})),i(null)},n.onerror=()=>{i("Failed to read the image file")},n.readAsDataURL(r)}},N=t=>{c(r=>({...r,[t.target.name]:t.target.value}))},w=async()=>{var t,r,m,p,g,n;if(console.log("Current user object:",a),!(a!=null&&a.id)){console.error("User ID is missing. User object:",a),i("User ID is missing");return}if(!((t=s.name)!=null&&t.trim())){i("Name is required");return}if(!((r=s.email)!=null&&r.trim())){i("Email is required");return}u(!0),i(null);try{console.log("Updating profile with data:",s);const l=await L.updateProfile(s);console.log("Profile update response:",l.data),y(l.data),f(!1)}catch(l){console.error("Error updating profile:",l),(p=(m=l.response)==null?void 0:m.data)!=null&&p.error?i(l.response.data.error):(n=(g=l.response)==null?void 0:g.data)!=null&&n.message?i(l.response.data.message):l.message?i(l.message):i("Failed to update profile. Please try again.")}finally{u(!1)}};return a?e.jsx("div",{className:"w-full min-h-screen bg-gradient-to-br from-white to-teal-50",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Profile"}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(E,{className:"max-w-xl w-full",children:[e.jsx(T,{children:e.jsx(A,{children:"Profile Information"})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{className:"h-16 w-16",children:b?e.jsx(z,{src:b,alt:s.name}):e.jsx(B,{children:(P=s.name)==null?void 0:P.charAt(0)})}),d&&e.jsxs("div",{children:[e.jsx(F,{children:e.jsxs(M,{children:[e.jsx(D,{asChild:!0,children:e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:I,className:"block mt-2 text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100","aria-label":"Upload profile image"})}),e.jsx(J,{children:"Upload a new profile image (max 2MB, JPG/PNG)"})]})}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Max size: 2MB. Supported formats: JPG, PNG, WebP"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-lg",children:s.name}),e.jsx("div",{className:"text-muted-foreground",children:a.role})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:"Email"}),e.jsx(C,{name:"email",value:s.email||"",onChange:N,readOnly:!d,"aria-label":"Email"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{children:"Phone Number"}),e.jsx(C,{name:"phoneNumber",value:s.phoneNumber||"",onChange:N,readOnly:!d,"aria-label":"Phone Number"})]}),j&&e.jsx("div",{className:"text-red-500 text-sm",children:j}),e.jsx("div",{className:"flex gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:w,disabled:h,"aria-label":"Save profile changes",children:h?"Saving...":"Save"}),e.jsx(x,{variant:"outline",onClick:()=>f(!1),"aria-label":"Cancel editing profile",children:"Cancel"})]}):e.jsx(x,{onClick:()=>f(!0),"aria-label":"Edit profile",children:"Edit Profile"})})]})]})})]})}):e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading profile..."})})};export{X as default};
