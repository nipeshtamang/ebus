import{j as e,t as ae,a as re,e as te,r as U,an as le,X as B,p as ne,ao as oe,i as ce,L as R,E as k,l as A}from"./ui-vendor-BA4r0Vfc.js";import{a as l}from"./react-vendor-CIX8g8kC.js";import{a as M}from"./utils-vendor-D-f4oM49.js";import{C as T,a as q,c as O,g as H,B as m,d as X,I as g,u as G}from"./api-CX4-puwJ.js";import{L as w}from"./label-DadenG8h.js";import{B as ie}from"./badge-sFmlWEB5.js";import{A as de,l as me,m as he,n as xe}from"./AdminLayout-Dhh5Bieh.js";import{u as ue}from"./index-DiI8FQ00.js";import"./query-vendor-COMjhFa0.js";function Ce(){const{user:r,updateUser:F}=ue(),[h,y]=l.useState(!1),[J,P]=l.useState(!1),[d,f]=l.useState(!1),[D,t]=l.useState(null),[z,b]=l.useState(null),[n,C]=l.useState(!1),[N,S]=l.useState(null),[K,I]=l.useState(null),[x,j]=l.useState({name:r?.name||"",phoneNumber:r?.phoneNumber||""}),[o,u]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""});l.useEffect(()=>{r&&j({name:r.name||"",phoneNumber:r.phoneNumber||""})},[r]);const Q=async s=>{const a=s.target.files?.[0];if(a){S(a);const E=await L(a);I(E)}},V=async()=>{try{f(!0),t(null);const s={name:x.name,phoneNumber:x.phoneNumber};if(N){const a=await L(N);s.profileImage=a}await G.updateProfile(s),F&&F({...r,...s}),b("Profile updated successfully!"),y(!1),S(null),I(null),setTimeout(()=>b(null),3e3)}catch(s){M.isAxiosError(s)&&s.response&&s.response.data&&typeof s.response.data=="object"&&"error"in s.response.data?t(s.response.data.error):s instanceof Error?t(s.message):t("Failed to update profile")}finally{f(!1)}},L=s=>new Promise((a,E)=>{const v=document.createElement("canvas"),ee=v.getContext("2d"),p=new Image;p.onload=()=>{let{width:c,height:i}=p;c>i?c>200&&(i=i*200/c,c=200):i>200&&(c=c*200/i,i=200),v.width=c,v.height=i,ee?.drawImage(p,0,0,c,i);const se=v.toDataURL("image/jpeg",.7);a(se)},p.onerror=E,p.src=URL.createObjectURL(s)}),W=async()=>{try{if(f(!0),t(null),o.newPassword!==o.confirmPassword){t("New passwords do not match");return}if(o.newPassword.length<6){t("Password must be at least 6 characters long");return}await G.changePassword({currentPassword:o.currentPassword,newPassword:o.newPassword}),b("Password changed successfully!"),P(!1),u({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>b(null),3e3)}catch(s){M.isAxiosError(s)&&s.response&&s.response.data&&typeof s.response.data=="object"&&"error"in s.response.data?t(s.response.data.error):s instanceof Error?t(s.message):t("Failed to change password")}finally{f(!1)}},Y=()=>{j({name:r?.name||"",phoneNumber:r?.phoneNumber||""}),y(!1),S(null),I(null),t(null)},Z=()=>{P(!1),u({currentPassword:"",newPassword:"",confirmPassword:""}),t(null)},_=s=>{switch(s.toUpperCase()){case"ADMIN":return"bg-blue-100 text-blue-800";case"SUPERADMIN":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},$=s=>s.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2);return e.jsx(de,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-teal-50/30 to-cyan-50/30",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-gradient-to-r from-white via-teal-50/50 to-cyan-50/50 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-b border-teal-100 shadow-sm px-4 py-4",children:e.jsx("div",{className:"max-w-7xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex aspect-square size-10 items-center justify-center rounded-xl bg-gradient-to-br from-teal-500 via-cyan-500 to-blue-500 text-white shadow-lg",children:e.jsx(ae,{className:"h-5 w-5"})}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"Profile Settings"})]})})}),e.jsxs("div",{className:"w-full mx-auto p-4",children:[D&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),D]})}),z&&e.jsx("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),z]})}),e.jsxs(T,{className:"shadow-xl border-0 bg-gradient-to-br from-white to-teal-50/30",children:[e.jsx(q,{className:"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(O,{className:"text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"Profile Information"}),e.jsx(H,{className:"text-gray-600",children:"Manage your account details"})]}),e.jsx("div",{className:"flex gap-2",children:h?e.jsxs(e.Fragment,{children:[e.jsxs(m,{onClick:V,disabled:d,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700",children:[d?e.jsx(U,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(le,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),e.jsxs(m,{onClick:Y,variant:"outline",disabled:d,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(m,{onClick:()=>y(!0),variant:"outline",className:"border-teal-200 hover:bg-teal-50",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]})}),e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 text-center",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsxs(me,{className:"h-24 w-24 mx-auto mb-4 border-4 border-teal-200",children:[e.jsx(he,{src:K||r?.profileImage||"/placeholder.svg?height=96&width=96",alt:"Profile"}),e.jsx(xe,{className:"text-2xl font-bold bg-gradient-to-br from-teal-500 to-cyan-500 text-white",children:$(x.name)})]}),h&&e.jsxs("label",{className:"absolute bottom-0 right-0 bg-teal-600 text-white p-2 rounded-full cursor-pointer hover:bg-teal-700 transition-colors",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("input",{type:"file",accept:"image/*",onChange:Q,className:"hidden"})]})]}),e.jsxs(ie,{className:_(r?.role||"ADMIN"),children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),r?.role||"ADMIN"]}),h&&N&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Image selected: ",N.name]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"name",className:"text-sm font-medium",children:"Full Name"}),e.jsx(g,{id:"name",value:x.name,onChange:s=>j(a=>({...a,name:s.target.value})),disabled:!h,className:"border-teal-200 focus:border-teal-500",placeholder:"Enter your full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"phone",className:"text-sm font-medium",children:"Phone Number"}),e.jsx(g,{id:"phone",value:x.phoneNumber,onChange:s=>j(a=>({...a,phoneNumber:s.target.value})),disabled:!h,className:"border-teal-200 focus:border-teal-500",placeholder:"Enter your phone number"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-teal-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Account Security"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-teal-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Password"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Change your account password"})]})]}),e.jsx(m,{onClick:()=>P(!0),variant:"outline",size:"sm",children:"Change Password"})]})})]})]})]})})]}),J&&e.jsxs(T,{className:"mt-6 shadow-xl border-0 bg-gradient-to-br from-white to-teal-50/30",children:[e.jsxs(q,{className:"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-t-lg",children:[e.jsx(O,{className:"text-xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"Change Password"}),e.jsx(H,{className:"text-gray-600",children:"Update your account password"})]}),e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"currentPassword",className:"text-sm font-medium",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"currentPassword",type:n?"text":"password",value:o.currentPassword,onChange:s=>u(a=>({...a,currentPassword:s.target.value})),className:"border-teal-200 focus:border-teal-500 pr-10",placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>C(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(k,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"newPassword",className:"text-sm font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"newPassword",type:n?"text":"password",value:o.newPassword,onChange:s=>u(a=>({...a,newPassword:s.target.value})),className:"border-teal-200 focus:border-teal-500 pr-10",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>C(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(k,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"confirmPassword",type:n?"text":"password",value:o.confirmPassword,onChange:s=>u(a=>({...a,confirmPassword:s.target.value})),className:"border-teal-200 focus:border-teal-500 pr-10",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>C(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(k,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(m,{onClick:W,disabled:d,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700",children:[d?e.jsx(U,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(R,{className:"h-4 w-4 mr-2"}),"Change Password"]}),e.jsxs(m,{onClick:Z,variant:"outline",disabled:d,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})})]})]})]})})}export{Ce as Profile,Ce as default};
