const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Admindashboard-C1dP-z2C.js","assets/ui-vendor-DMBPzNwu.js","assets/react-vendor-C8rorRqO.js","assets/api-C7d73vgv.js","assets/utils-vendor-BIYRr1x_.js","assets/badge-BRWl9YMx.js","assets/AdminLayout-lzRtiUax.js","assets/skeleton-jijkxZMJ.js","assets/success-message-BsusCHyT.js","assets/query-vendor-Dv9SXHgC.js","assets/Loginpage-DlNntBpx.js","assets/label-CZBUESOW.js","assets/ForgotPassword-DisGfqx5.js","assets/ScheduleList-DKBxoB69.js","assets/select-D3T-VKQN.js","assets/bus-seat-layout-Q92fS2Nq.js","assets/BookingList-DoYj8evq.js","assets/textarea-ZISeY5eG.js","assets/BookingForm-t3g02ycw.js","assets/radio-group-C06cumB1.js","assets/PaymentHistory-BL8ar8fS.js","assets/BusSearchPage-BuzmiiQX.js","assets/Profile-B9vtivid.js"])))=>i.map(i=>d[i]);
import{j as e}from"./ui-vendor-DMBPzNwu.js";import{a as k,r as s,d as N,e as x,N as b,B as R}from"./react-vendor-C8rorRqO.js";import{Q as C,a as O}from"./query-vendor-Dv9SXHgC.js";import{a as P}from"./utils-vendor-BIYRr1x_.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))g(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&g(n)}).observe(document,{childList:!0,subtree:!0});function i(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function g(o){if(o.ep)return;o.ep=!0;const t=i(o);fetch(o.href,t)}})();var j={},E=k;j.createRoot=E.createRoot,j.hydrateRoot=E.hydrateRoot;const A=s.createContext(void 0),z=({children:r})=>{const[m,i]=s.useState(null),[g,o]=s.useState(null),[t,n]=s.useState(!0),[l,h]=s.useState(!1),p=c=>{try{return JSON.parse(atob(c.split(".")[1])).exp*1e3<Date.now()}catch{return!0}};s.useEffect(()=>{(()=>{try{const u=localStorage.getItem("auth_token"),L=localStorage.getItem("auth_user");if(u&&L)if(p(u))console.log("Stored token is expired, clearing auth data"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),o(null),i(null);else{const I=JSON.parse(L);o(u),i(I),P.defaults.headers.common.Authorization=`Bearer ${u}`}}catch(u){console.error("Error initializing auth:",u),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user")}finally{n(!1),h(!0)}})()},[]);const y=(c,u)=>{o(c),i(u),localStorage.setItem("auth_token",c),localStorage.setItem("auth_user",JSON.stringify(u)),P.defaults.headers.common.Authorization=`Bearer ${c}`},d=()=>{o(null),i(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),delete P.defaults.headers.common.Authorization,window.location.pathname!=="/LoginPage"&&(window.location.href="/LoginPage")},_=c=>{if(m){const u={...m,...c};i(u),localStorage.setItem("auth_user",JSON.stringify(u))}},v=async()=>{try{const c=localStorage.getItem("auth_token");return c?p(c)?(d(),!1):!0:!1}catch(c){return console.error("Error refreshing token:",c),d(),!1}};return e.jsx(A.Provider,{value:{user:m,token:g,isLoading:t,isInitialized:l,login:y,logout:d,updateUser:_,refreshToken:v},children:r})};function B(){const r=s.useContext(A);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r}const D="modulepreload",T=function(r){return"/"+r},S={},f=function(m,i,g){let o=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),l=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));o=Promise.allSettled(i.map(h=>{if(h=T(h),h in S)return;S[h]=!0;const p=h.endsWith(".css"),y=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const d=document.createElement("link");if(d.rel=p?"stylesheet":D,p||(d.as="script"),d.crossOrigin="",d.href=h,l&&d.setAttribute("nonce",l),document.head.appendChild(d),p)return new Promise((_,v)=>{d.addEventListener("load",_),d.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function t(n){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=n,window.dispatchEvent(l),!l.defaultPrevented)throw n}return o.then(n=>{for(const l of n||[])l.status==="rejected"&&t(l.reason);return m().catch(t)})},a={LoginPage:"/LoginPage",ForgotPassword:"/forgot-password",AdminDashboard:"/AdminDashboard",ScheduleList:"/schedules",BookingList:"/bookings",BookingForm:"/bookings/new",PaymentHistory:"/payments",Profile:"/profile",BusSearchPage:"/bus-search"},F=s.lazy(()=>f(()=>import("./Admindashboard-C1dP-z2C.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),U=s.lazy(()=>f(()=>import("./Loginpage-DlNntBpx.js"),__vite__mapDeps([10,1,2,5,3,4,11,9])).then(r=>({default:r.LoginPage}))),V=s.lazy(()=>f(()=>import("./ForgotPassword-DisGfqx5.js"),__vite__mapDeps([12,1,2,3,4,11,9]))),q=s.lazy(()=>f(()=>import("./ScheduleList-DKBxoB69.js"),__vite__mapDeps([13,1,2,3,4,5,14,6,15,7,9])).then(r=>({default:r.ScheduleList}))),$=s.lazy(()=>f(()=>import("./BookingList-DoYj8evq.js"),__vite__mapDeps([16,1,2,3,4,14,6,17,15,5,8,11,7,9])).then(r=>({default:r.BookingList}))),H=s.lazy(()=>f(()=>import("./BookingForm-t3g02ycw.js"),__vite__mapDeps([18,1,2,3,4,11,19,6,15,5,9])).then(r=>({default:r.BookingForm}))),J=s.lazy(()=>f(()=>import("./PaymentHistory-BL8ar8fS.js"),__vite__mapDeps([20,1,2,3,4,5,14,17,11,6,8,9])).then(r=>({default:r.PaymentHistory}))),Q=s.lazy(()=>f(()=>import("./BusSearchPage-BuzmiiQX.js"),__vite__mapDeps([21,1,2,5,3,4,11,19,6,15,9])).then(r=>({default:r.BusSearchPage}))),G=s.lazy(()=>f(()=>import("./Profile-B9vtivid.js"),__vite__mapDeps([22,1,2,4,3,11,5,6,9]))),w=[{path:a.LoginPage,Component:U},{path:a.ForgotPassword,Component:V},{path:a.AdminDashboard,Component:F},{path:a.ScheduleList,Component:q},{path:a.BookingList,Component:$},{path:a.BookingForm,Component:H},{path:a.PaymentHistory,Component:J},{path:a.BusSearchPage,Component:Q},{path:a.Profile,Component:G}],K=()=>e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 via-teal-50/30 to-cyan-50/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});function W(){const{user:r,isLoading:m,isInitialized:i}=B(),g=[a.LoginPage,a.ForgotPassword],o=w.filter(t=>!g.includes(t.path));return!i||m?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 via-teal-50/30 to-cyan-50/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Initializing..."})]})}):e.jsx("div",{className:"app-min-h-screen",children:e.jsx(s.Suspense,{fallback:e.jsx(K,{}),children:e.jsxs(N,{children:[e.jsx(x,{path:"/",element:e.jsx(b,{to:r?a.AdminDashboard:a.LoginPage,replace:!0})}),g.map(t=>{const n=w.find(l=>l.path===t);return e.jsx(x,{path:t,element:r?e.jsx(b,{to:a.AdminDashboard,replace:!0}):n?e.jsx(n.Component,{}):e.jsx("div",{children:"Page not found"})},t)}),o.map(t=>e.jsx(x,{path:t.path,element:r?e.jsx(t.Component,{}):e.jsx(b,{to:a.LoginPage,replace:!0})},t.path)),e.jsx(x,{path:"*",element:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 via-teal-50/30 to-cyan-50/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex aspect-square size-20 items-center justify-center rounded-xl bg-gradient-to-br from-teal-500 via-cyan-500 to-blue-500 text-white shadow-lg mx-auto mb-6",children:e.jsx("span",{className:"text-4xl font-bold",children:"404"})}),e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The page you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>window.history.back(),className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white px-6 py-2 rounded-lg transition-all duration-200",children:"Go Back"})]})})})]})})})}function X(){return e.jsx(W,{})}const Y=new C;j.createRoot(document.getElementById("root")).render(e.jsx(O,{client:Y,children:e.jsx(R,{children:e.jsx(z,{children:e.jsx(X,{})})})}));export{a as R,B as u};
