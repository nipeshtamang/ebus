import{j as e,n as b,R as V,a as z,S as O,M as q,B as $,g as G,l as J}from"./ui-vendor-DMBPzNwu.js";import{r as t}from"./react-vendor-C8rorRqO.js";import{B as N,C as y,a as v,c as w,d as S,I as K,s as Q}from"./api-C7d73vgv.js";import{B as U}from"./badge-BRWl9YMx.js";import{S as W,a as X,b as Y,c as Z,d as C}from"./select-D3T-VKQN.js";import{A as D,a as _,b as ee,c as se,d as ae,e as te,f as re}from"./AdminLayout-lzRtiUax.js";import{B as le}from"./bus-seat-layout-Q92fS2Nq.js";import{T as ie}from"./skeleton-jijkxZMJ.js";import{f as ne}from"./utils-vendor-BIYRr1x_.js";import"./index-DnDBnOSx.js";import"./query-vendor-Dv9SXHgC.js";function be(){const[d,A]=t.useState([]),[B,m]=t.useState(!1),[x,h]=t.useState(null),[l,L]=t.useState(""),[i,R]=t.useState("all"),[u,j]=t.useState(!1),[T,g]=t.useState(!1),[r,k]=t.useState(null),f=async()=>{try{m(!0),h(null);const s=await Q.getAllSchedules();A(s.data)}catch(s){let a="Failed to fetch schedules.";s&&typeof s=="object"&&"message"in s&&(a=s.message),h(a)}finally{m(!1)}};t.useEffect(()=>{f()},[]);const F=async()=>{j(!0),await f(),j(!1)},M=s=>{k(s),g(!0)},I=s=>ne(new Date(s),"MMM dd, yyyy HH:mm"),E=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"NPR",minimumFractionDigits:0}).format(s),n=s=>s.seats.filter(a=>!a.isBooked).length,p=s=>{const a=s.seats.length,o=a-n(s);return Math.round(o/a*100)},H=s=>s>=80?"text-red-600":s>=60?"text-yellow-600":"text-green-600",c=d.filter(s=>{const a=s.route.origin.toLowerCase().includes(l.toLowerCase())||s.route.destination.toLowerCase().includes(l.toLowerCase())||s.bus.name.toLowerCase().includes(l.toLowerCase()),o=i==="all"||s.route.origin.toLowerCase().includes(i.toLowerCase())||s.route.destination.toLowerCase().includes(i.toLowerCase());return a&&o}),P=Array.from(new Set(d.flatMap(s=>[s.route.origin,s.route.destination]))).sort();return B?e.jsx(D,{children:e.jsx(ie,{})}):e.jsx(D,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-teal-50/30 to-cyan-50/30",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-gradient-to-r from-white via-teal-50/50 to-cyan-50/50 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-b border-teal-100 shadow-sm px-4 py-4",children:e.jsx("div",{className:"max-w-7xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex aspect-square size-10 items-center justify-center rounded-xl bg-gradient-to-br from-teal-500 via-cyan-500 to-blue-500 text-white shadow-lg",children:e.jsx(b,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"All Schedules"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View and manage bus schedules and routes"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(N,{variant:"outline",onClick:F,disabled:u,className:"border-teal-200 hover:bg-teal-50",children:[e.jsx(V,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),"Refresh"]})})]})})}),e.jsxs("div",{className:"w-full mx-auto p-4",children:[x&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),x]})}),e.jsxs(y,{className:"shadow-xl border-0 bg-gradient-to-br from-white to-teal-50/30 mb-6",children:[e.jsx(v,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5 text-teal-600"}),"Search & Filters"]})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Search"}),e.jsx(K,{placeholder:"Search by route or bus name...",value:l,onChange:s=>L(s.target.value),className:"border-teal-200 focus:border-teal-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Route Filter"}),e.jsxs(W,{value:i,onValueChange:R,children:[e.jsx(X,{className:"border-teal-200 focus:border-teal-500",children:e.jsx(Y,{placeholder:"All routes"})}),e.jsxs(Z,{children:[e.jsx(C,{value:"all",children:"All Routes"}),P.map(s=>e.jsx(C,{value:s,children:s},s))]})]})]})]})})]}),e.jsxs(y,{className:"shadow-xl border-0 bg-gradient-to-br from-white to-teal-50/30",children:[e.jsx(v,{children:e.jsx(w,{className:"flex items-center justify-between",children:e.jsxs("span",{children:["Schedules (",c.length,")"]})})}),e.jsx(S,{children:c.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(b,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No schedules found"}),e.jsx("p",{className:"text-sm",children:l||i!=="all"?"Try adjusting your search criteria.":"No schedules have been created yet."})]}):e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-6 border border-teal-100 rounded-lg hover:bg-teal-50/50 transition-all duration-200",children:[e.jsx("div",{className:"flex items-center space-x-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-teal-600"}),e.jsxs("span",{className:"font-medium",children:[s.route.origin," â†’"," ",s.route.destination]}),s.isReturn&&e.jsx(U,{variant:"secondary",className:"text-xs",children:"Return"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx($,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.bus.name})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(G,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:I(s.departure)})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-teal-600",children:E(s.fare)}),e.jsxs("div",{className:"text-sm text-gray-500",children:[n(s)," seats available"]}),e.jsxs("div",{className:`text-xs ${H(p(s))}`,children:[p(s),"% occupied"]})]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>M(s),className:"border-teal-200 hover:bg-teal-50",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"View Details"]})]})]},s.id))})})]})]}),e.jsx(_,{open:T,onOpenChange:g,children:e.jsxs(ee,{className:"max-w-2xl",children:[e.jsx(se,{children:e.jsx(ae,{children:"Bus Details"})}),r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Bus Name:"})," ",r.bus.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Layout:"})," ",r.bus.layoutType]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total Seats:"})," ",r.bus.seatCount]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Available Seats:"})," ",n(r)]})]}),e.jsx(le,{layoutType:r.bus.layoutType,seats:r.seats,busName:r.bus.name,compact:!1,showLegend:!0})]}),e.jsx(te,{children:e.jsx(re,{children:"Close"})})]})})]})})}export{be as ScheduleList};
