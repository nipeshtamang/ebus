import{j as e,t as ae,a as re,e as te,r as B,an as le,X as R,p as ne,ao as oe,i as ce,L as M,E as A,l as F}from"./ui-vendor-DMBPzNwu.js";import{r as l}from"./react-vendor-C8rorRqO.js";import{a as T}from"./utils-vendor-BIYRr1x_.js";import{C as q,a as O,c as H,g as X,B as h,d as G,I as w,u as J}from"./api-C7d73vgv.js";import{L as f}from"./label-CZBUESOW.js";import{B as ie}from"./badge-BRWl9YMx.js";import{A as de,l as me,m as he,n as xe}from"./AdminLayout-lzRtiUax.js";import{u as ue}from"./index-DnDBnOSx.js";import"./query-vendor-Dv9SXHgC.js";function Ce(){const{user:a,updateUser:D}=ue(),[x,P]=l.useState(!1),[K,C]=l.useState(!1),[d,b]=l.useState(!1),[z,t]=l.useState(null),[L,N]=l.useState(null),[n,S]=l.useState(!1),[j,I]=l.useState(null),[Q,E]=l.useState(null),[u,v]=l.useState({name:(a==null?void 0:a.name)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||""}),[o,p]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""});l.useEffect(()=>{a&&v({name:a.name||"",phoneNumber:a.phoneNumber||""})},[a]);const V=async s=>{var y;const r=(y=s.target.files)==null?void 0:y[0];if(r){I(r);const m=await U(r);E(m)}},W=async()=>{try{b(!0),t(null);const s={name:u.name,phoneNumber:u.phoneNumber};if(j){const r=await U(j);s.profileImage=r}await J.updateProfile(s),D&&D({...a,...s}),N("Profile updated successfully!"),P(!1),I(null),E(null),setTimeout(()=>N(null),3e3)}catch(s){T.isAxiosError(s)&&s.response&&s.response.data&&typeof s.response.data=="object"&&"error"in s.response.data?t(s.response.data.error):s instanceof Error?t(s.message):t("Failed to update profile")}finally{b(!1)}},U=s=>new Promise((r,y)=>{const m=document.createElement("canvas"),k=m.getContext("2d"),g=new Image;g.onload=()=>{let{width:c,height:i}=g;c>i?c>200&&(i=i*200/c,c=200):i>200&&(c=c*200/i,i=200),m.width=c,m.height=i,k==null||k.drawImage(g,0,0,c,i);const se=m.toDataURL("image/jpeg",.7);r(se)},g.onerror=y,g.src=URL.createObjectURL(s)}),Y=async()=>{try{if(b(!0),t(null),o.newPassword!==o.confirmPassword){t("New passwords do not match");return}if(o.newPassword.length<6){t("Password must be at least 6 characters long");return}await J.changePassword({currentPassword:o.currentPassword,newPassword:o.newPassword}),N("Password changed successfully!"),C(!1),p({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>N(null),3e3)}catch(s){T.isAxiosError(s)&&s.response&&s.response.data&&typeof s.response.data=="object"&&"error"in s.response.data?t(s.response.data.error):s instanceof Error?t(s.message):t("Failed to change password")}finally{b(!1)}},Z=()=>{v({name:(a==null?void 0:a.name)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||""}),P(!1),I(null),E(null),t(null)},_=()=>{C(!1),p({currentPassword:"",newPassword:"",confirmPassword:""}),t(null)},$=s=>{switch(s.toUpperCase()){case"ADMIN":return"bg-blue-100 text-blue-800";case"SUPERADMIN":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},ee=s=>s.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,2);return e.jsx(de,{children:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-teal-50/30 to-cyan-50/30",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-gradient-to-r from-white via-teal-50/50 to-cyan-50/50 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-b border-teal-100 shadow-sm px-4 py-4",children:e.jsx("div",{className:"max-w-7xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex aspect-square size-10 items-center justify-center rounded-xl bg-gradient-to-br from-teal-500 via-cyan-500 to-blue-500 text-white shadow-lg",children:e.jsx(ae,{className:"h-5 w-5"})}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"Profile Settings"})]})})}),e.jsxs("div",{className:"w-full mx-auto p-4",children:[z&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),z]})}),L&&e.jsx("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),L]})}),e.jsxs(q,{className:"shadow-xl border-0 bg-gradient-to-br from-white to-teal-50/30",children:[e.jsx(O,{className:"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(H,{className:"text-2xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"Profile Information"}),e.jsx(X,{className:"text-gray-600",children:"Manage your account details"})]}),e.jsx("div",{className:"flex gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsxs(h,{onClick:W,disabled:d,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700",children:[d?e.jsx(B,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(le,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),e.jsxs(h,{onClick:Z,variant:"outline",disabled:d,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(h,{onClick:()=>P(!0),variant:"outline",className:"border-teal-200 hover:bg-teal-50",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]})}),e.jsx(G,{className:"p-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 text-center",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsxs(me,{className:"h-24 w-24 mx-auto mb-4 border-4 border-teal-200",children:[e.jsx(he,{src:Q||(a==null?void 0:a.profileImage)||"/placeholder.svg?height=96&width=96",alt:"Profile"}),e.jsx(xe,{className:"text-2xl font-bold bg-gradient-to-br from-teal-500 to-cyan-500 text-white",children:ee(u.name)})]}),x&&e.jsxs("label",{className:"absolute bottom-0 right-0 bg-teal-600 text-white p-2 rounded-full cursor-pointer hover:bg-teal-700 transition-colors",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx("input",{type:"file",accept:"image/*",onChange:V,className:"hidden"})]})]}),e.jsxs(ie,{className:$((a==null?void 0:a.role)||"ADMIN"),children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),(a==null?void 0:a.role)||"ADMIN"]}),x&&j&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Image selected: ",j.name]})]}),e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"name",className:"text-sm font-medium",children:"Full Name"}),e.jsx(w,{id:"name",value:u.name,onChange:s=>v(r=>({...r,name:s.target.value})),disabled:!x,className:"border-teal-200 focus:border-teal-500",placeholder:"Enter your full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"phone",className:"text-sm font-medium",children:"Phone Number"}),e.jsx(w,{id:"phone",value:u.phoneNumber,onChange:s=>v(r=>({...r,phoneNumber:s.target.value})),disabled:!x,className:"border-teal-200 focus:border-teal-500",placeholder:"Enter your phone number"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-teal-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Account Security"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-teal-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Password"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Change your account password"})]})]}),e.jsx(h,{onClick:()=>C(!0),variant:"outline",size:"sm",children:"Change Password"})]})})]})]})]})})]}),K&&e.jsxs(q,{className:"mt-6 shadow-xl border-0 bg-gradient-to-br from-white to-teal-50/30",children:[e.jsxs(O,{className:"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-t-lg",children:[e.jsx(H,{className:"text-xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent",children:"Change Password"}),e.jsx(X,{className:"text-gray-600",children:"Update your account password"})]}),e.jsx(G,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"currentPassword",className:"text-sm font-medium",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{id:"currentPassword",type:n?"text":"password",value:o.currentPassword,onChange:s=>p(r=>({...r,currentPassword:s.target.value})),className:"border-teal-200 focus:border-teal-500 pr-10",placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>S(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(A,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"newPassword",className:"text-sm font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{id:"newPassword",type:n?"text":"password",value:o.newPassword,onChange:s=>p(r=>({...r,newPassword:s.target.value})),className:"border-teal-200 focus:border-teal-500 pr-10",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>S(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(A,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{id:"confirmPassword",type:n?"text":"password",value:o.confirmPassword,onChange:s=>p(r=>({...r,confirmPassword:s.target.value})),className:"border-teal-200 focus:border-teal-500 pr-10",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>S(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?e.jsx(A,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(h,{onClick:Y,disabled:d,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700",children:[d?e.jsx(B,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(M,{className:"h-4 w-4 mr-2"}),"Change Password"]}),e.jsxs(h,{onClick:_,variant:"outline",disabled:d,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})})]})]})]})})}export{Ce as Profile,Ce as default};
